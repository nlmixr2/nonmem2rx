<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Importing NONMEM into rxode2 • nonmem2rx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Importing NONMEM into rxode2">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nonmem2rx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-converting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-arrow-right"></span> Converting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-converting">
<li><a class="dropdown-item" href="../articles/import-nonmem.html">Converting NONMEM to rxode2 model</a></li>
    <li><a class="dropdown-item" href="../articles/convert-nlmixr2.html">Converting NONMEM to nlmixr2 object</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/rxode2-validate.html"><span class="fa fa-check"></span> Qualify</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-dice"></span> Simulation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulation">
<li><a class="dropdown-item" href="../articles/simulate-new-dosing.html">New Dosing Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-uncertainty.html">Simulating with Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-extra-items.html">Simulating with Derived Variables</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-new-dosing-with-covs.html">Simulating with Covariates/Input PK parameters</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reporting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reporting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reporting">
<li><a class="dropdown-item" href="../articles/create-office.html">Creating word and powerpoint documents</a></li>
    <li><a class="dropdown-item" href="../articles/create-vpc.html">Easily create VPC plots</a></li>
    <li><a class="dropdown-item" href="../articles/create-augPred.html">Create enriched Individual plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/read-rounding.html"><span class="fa fa-bug"></span> Debug</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-rss"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nonmem2rx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Importing NONMEM into rxode2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nonmem2rx/blob/main/vignettes/import-nonmem.Rmd" class="external-link"><code>vignettes/import-nonmem.Rmd</code></a></small>
      <div class="d-none name"><code>import-nonmem.Rmd</code></div>
    </div>

    
    
<p>The goal of <code>nonmem2rx</code> is to convert a NONMEM control
stream to <code>rxode2</code> for easy clinical trial simulation in
R.</p>
<p>Here is a quick example of a conversion:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nonmem2rx/" class="external-link">nonmem2rx</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First we need the location of the nonmem control stream Since we are running an example, we will use one of the built-in examples in `nonmem2rx`</span></span>
<span><span class="va">ctlFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"mods/cpt/runODE032.ctl"</span>, package<span class="op">=</span><span class="st">"nonmem2rx"</span><span class="op">)</span></span>
<span><span class="co"># You can use a control stream or other file. With the development</span></span>
<span><span class="co"># version of `babelmixr2`, you can simply point to the listing file</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="va">ctlFile</span>, lst<span class="op">=</span><span class="st">".res"</span>, save<span class="op">=</span><span class="cn">FALSE</span>, determineError<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  '/home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.ctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in xml file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in ext file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in phi file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> abbreviated list parsing</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $MODEL</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $gTHETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SUBROUTINES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PK</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ERROR</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta1` to `1.37034036528946`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta2` to `4.19814911033061`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta3` to `1.38003493562413`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta4` to `3.87657341967489`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta5` to `0.196446108190896`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta1` to `0.101251418415006`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta2` to `0.0993872449483344`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta3` to `0.101302674763154`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta4` to `0.0730497519364148`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem input data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/Bolus_2CPT.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> ignoring lines that begin with a letter (IGNORE=@)'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> applying names specified by $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> subsetting accept/ignore filters code: .data[-which((.data$SD == 0)),]</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem IPRED data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done (no labels)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming compartments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 2-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;    theta1    theta2    theta3    theta4       RSV </span></span>
<span><span class="co">#&gt; 1.3703404 4.1981491 1.3800349 3.8765734 0.1964461 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;           eta1       eta2      eta3       eta4</span></span>
<span><span class="co">#&gt; eta1 0.1012514 0.00000000 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta2 0.0000000 0.09938724 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta3 0.0000000 0.00000000 0.1013027 0.00000000</span></span>
<span><span class="co">#&gt; eta4 0.0000000 0.00000000 0.0000000 0.07304975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1          CENTRAL</span></span>
<span><span class="co">#&gt; 2                  2             PERI</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;    theta  eta level</span></span>
<span><span class="co">#&gt; 1 theta1 eta1    id</span></span>
<span><span class="co">#&gt; 2 theta2 eta2    id</span></span>
<span><span class="co">#&gt; 3 theta3 eta3    id</span></span>
<span><span class="co">#&gt; 4 theta4 eta4    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "BOLUS_2CPT_CLV1QV2 SINGLE DOSE FOCEI (120 Ind/2280 Obs) runODE032"</span></span>
<span><span class="co">#&gt;     dfObs &lt;- 2280</span></span>
<span><span class="co">#&gt;     dfSub &lt;- 120</span></span>
<span><span class="co">#&gt;     sigma &lt;- lotri({</span></span>
<span><span class="co">#&gt;         eps1 ~ 1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     thetaMat &lt;- lotri({</span></span>
<span><span class="co">#&gt;         theta1 ~ c(theta1 = 0.000887681)</span></span>
<span><span class="co">#&gt;         theta2 ~ c(theta1 = -0.00010551, theta2 = 0.000871409)</span></span>
<span><span class="co">#&gt;         theta3 ~ c(theta1 = 0.000184416, theta2 = -0.000106195, </span></span>
<span><span class="co">#&gt;             theta3 = 0.00299336)</span></span>
<span><span class="co">#&gt;         theta4 ~ c(theta1 = -0.000120234, theta2 = -5.06663e-05, </span></span>
<span><span class="co">#&gt;             theta3 = 0.000165252, theta4 = 0.00121347)</span></span>
<span><span class="co">#&gt;         RSV ~ c(theta1 = 5.2783e-08, theta2 = -1.56562e-05, theta3 = 5.99331e-06, </span></span>
<span><span class="co">#&gt;             theta4 = -2.53991e-05, RSV = 9.94218e-06)</span></span>
<span><span class="co">#&gt;         eps1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0)</span></span>
<span><span class="co">#&gt;         eta1 ~ c(theta1 = -4.71273e-05, theta2 = 4.69667e-05, </span></span>
<span><span class="co">#&gt;             theta3 = -3.64271e-05, theta4 = 2.54796e-05, RSV = -8.16885e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 0.000169296)</span></span>
<span><span class="co">#&gt;         omega.2.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0)</span></span>
<span><span class="co">#&gt;         eta2 ~ c(theta1 = -7.37156e-05, theta2 = 2.56634e-05, </span></span>
<span><span class="co">#&gt;             theta3 = -8.08349e-05, theta4 = 1.37e-05, RSV = -4.36564e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 8.75181e-06, omega.2.1 = 0, eta2 = 0.00015125)</span></span>
<span><span class="co">#&gt;         omega.3.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.3.2 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0)</span></span>
<span><span class="co">#&gt;         eta3 ~ c(theta1 = 6.63383e-05, theta2 = -8.19002e-05, </span></span>
<span><span class="co">#&gt;             theta3 = 0.000548985, theta4 = 0.000168356, RSV = 1.59122e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 3.48714e-05, omega.2.1 = 0, eta2 = 4.31593e-07, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0.000959029)</span></span>
<span><span class="co">#&gt;         omega.4.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.2 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.3 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0, omega.4.3 = 0)</span></span>
<span><span class="co">#&gt;         eta4 ~ c(theta1 = -9.49661e-06, theta2 = 0.000110108, </span></span>
<span><span class="co">#&gt;             theta3 = -0.000306537, theta4 = -9.12897e-05, RSV = 3.1877e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 1.36628e-05, omega.2.1 = 0, eta2 = -1.95096e-05, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = -0.00012977, </span></span>
<span><span class="co">#&gt;             omega.4.1 = 0, omega.4.2 = 0, omega.4.3 = 0, eta4 = 0.00051019)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.43e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.19e-05, 0.0418); atol=0.00167", </span></span>
<span><span class="co">#&gt;         "IWRES relative difference compared to Nonmem IWRES: 0%; 95% percentile: (0%,0.01%); rtol=8.99e-06", </span></span>
<span><span class="co">#&gt;         "IWRES absolute difference compared to Nonmem IWRES: 95% percentile: (1.82e-07, 4.63e-05); atol=3.65e-06", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.41e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (1.41e-07,0.00382) atol=6.41e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         theta1 &lt;- 1.37034036528946</span></span>
<span><span class="co">#&gt;         label("log Cl")</span></span>
<span><span class="co">#&gt;         theta2 &lt;- 4.19814911033061</span></span>
<span><span class="co">#&gt;         label("log Vc")</span></span>
<span><span class="co">#&gt;         theta3 &lt;- 1.38003493562413</span></span>
<span><span class="co">#&gt;         label("log Q")</span></span>
<span><span class="co">#&gt;         theta4 &lt;- 3.87657341967489</span></span>
<span><span class="co">#&gt;         label("log Vp")</span></span>
<span><span class="co">#&gt;         RSV &lt;- c(0, 0.196446108190896, 1)</span></span>
<span><span class="co">#&gt;         label("RSV")</span></span>
<span><span class="co">#&gt;         eta1 ~ 0.101251418415006</span></span>
<span><span class="co">#&gt;         eta2 ~ 0.0993872449483344</span></span>
<span><span class="co">#&gt;         eta3 ~ 0.101302674763154</span></span>
<span><span class="co">#&gt;         eta4 ~ 0.0730497519364148</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(CENTRAL)</span></span>
<span><span class="co">#&gt;         cmt(PERI)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(theta1 + eta1)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(theta2 + eta2)</span></span>
<span><span class="co">#&gt;         q &lt;- exp(theta3 + eta3)</span></span>
<span><span class="co">#&gt;         v2 &lt;- exp(theta4 + eta4)</span></span>
<span><span class="co">#&gt;         v1 &lt;- v</span></span>
<span><span class="co">#&gt;         scale1 &lt;- v</span></span>
<span><span class="co">#&gt;         k21 &lt;- q/v2</span></span>
<span><span class="co">#&gt;         k12 &lt;- q/v</span></span>
<span><span class="co">#&gt;         d/dt(CENTRAL) &lt;- k21 * PERI - k12 * CENTRAL - cl * CENTRAL/v1</span></span>
<span><span class="co">#&gt;         d/dt(PERI) &lt;- -k21 * PERI + k12 * CENTRAL</span></span>
<span><span class="co">#&gt;         f &lt;- CENTRAL/scale1</span></span>
<span><span class="co">#&gt;         ipred &lt;- f</span></span>
<span><span class="co">#&gt;         rescv &lt;- RSV</span></span>
<span><span class="co">#&gt;         w &lt;- ipred * rescv</span></span>
<span><span class="co">#&gt;         ires &lt;- DV - ipred</span></span>
<span><span class="co">#&gt;         iwres &lt;- ires/w</span></span>
<span><span class="co">#&gt;         y &lt;- ipred + w * eps1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx translation notes (</span><span style="color: #0000BB; font-weight: bold;">$notes</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;    • there are duplicate eta names, not renaming duplicate parameters </span></span>
<span><span class="co">#&gt;    • there are duplicate theta names, not renaming duplicate parameters </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Sigma</span> (<span style="color: #0000BB; font-weight: bold;">$sigma</span>): </span></span>
<span><span class="co">#&gt;      eps1</span></span>
<span><span class="co">#&gt; eps1    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<div class="section level2">
<h2 id="setting-up-nonmem2rx-for-your-model">Setting up <code>nonmem2rx</code> for your model<a class="anchor" aria-label="anchor" href="#setting-up-nonmem2rx-for-your-model"></a>
</h2>
<p>Some common options that you may want to change when importing NONMEM
control stream are:</p>
<ul>
<li><p>The default NONMEM output extension; By default it is
<code>.lst</code>. You can set it to something else, like
<code>.res</code>, using the following option:
<code>options(nonmem2rx.lst=".res")</code>.</p></li>
<li><p>Turn on <a href="https://wfn.sourceforge.net/wfncs.htm#control_streams" class="external-link">extended
control stream</a> support. You can turn it on by
<code>options(nonmem2rx.extended=TRUE)</code></p></li>
</ul>
<p>You probably also want to change the name of parameters and
compartments. The easiest way to name the parameters whatever you want
is to pre-specify the names. For example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"mods/cpt/runODE032.ctl"</span>, package<span class="op">=</span><span class="st">"nonmem2rx"</span><span class="op">)</span>, lst<span class="op">=</span><span class="st">".res"</span>, save<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                 thetaNames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lcl"</span>, <span class="st">"lvc"</span>, <span class="st">"lq"</span>, <span class="st">"lvp"</span>, <span class="st">"prop.sd"</span><span class="op">)</span>,</span>
<span>                 etaNames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta.cl"</span>, <span class="st">"eta.vc"</span>, <span class="st">"eta.q"</span>,<span class="st">"eta.vp"</span><span class="op">)</span>,</span>
<span>                 cmtNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"central"</span>, <span class="st">"perip"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  '/home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.ctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in xml file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in ext file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in phi file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> abbreviated list parsing</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $MODEL</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $gTHETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SUBROUTINES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PK</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ERROR</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta1` to `1.37034036528946`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta2` to `4.19814911033061`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta3` to `1.38003493562413`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta4` to `3.87657341967489`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta5` to `0.196446108190896`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta1` to `0.101251418415006`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta2` to `0.0993872449483344`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta3` to `0.101302674763154`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta4` to `0.0730497519364148`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem input data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/Bolus_2CPT.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> ignoring lines that begin with a letter (IGNORE=@)'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> applying names specified by $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> subsetting accept/ignore filters code: .data[-which((.data$SD == 0)),]</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem IPRED data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming compartments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 2-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;       lcl       lvc        lq       lvp   prop.sd </span></span>
<span><span class="co">#&gt; 1.3703404 4.1981491 1.3800349 3.8765734 0.1964461 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;           eta.cl     eta.vc     eta.q     eta.vp</span></span>
<span><span class="co">#&gt; eta.cl 0.1012514 0.00000000 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta.vc 0.0000000 0.09938724 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta.q  0.0000000 0.00000000 0.1013027 0.00000000</span></span>
<span><span class="co">#&gt; eta.vp 0.0000000 0.00000000 0.0000000 0.07304975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1          central</span></span>
<span><span class="co">#&gt; 2                  2            perip</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   theta    eta level</span></span>
<span><span class="co">#&gt; 1   lcl eta.cl    id</span></span>
<span><span class="co">#&gt; 2   lvc eta.vc    id</span></span>
<span><span class="co">#&gt; 3    lq  eta.q    id</span></span>
<span><span class="co">#&gt; 4   lvp eta.vp    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "BOLUS_2CPT_CLV1QV2 SINGLE DOSE FOCEI (120 Ind/2280 Obs) runODE032"</span></span>
<span><span class="co">#&gt;     dfObs &lt;- 2280</span></span>
<span><span class="co">#&gt;     dfSub &lt;- 120</span></span>
<span><span class="co">#&gt;     sigma &lt;- lotri({</span></span>
<span><span class="co">#&gt;         eps1 ~ 1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     thetaMat &lt;- lotri({</span></span>
<span><span class="co">#&gt;         lcl ~ c(lcl = 0.000887681)</span></span>
<span><span class="co">#&gt;         lvc ~ c(lcl = -0.00010551, lvc = 0.000871409)</span></span>
<span><span class="co">#&gt;         lq ~ c(lcl = 0.000184416, lvc = -0.000106195, lq = 0.00299336)</span></span>
<span><span class="co">#&gt;         lvp ~ c(lcl = -0.000120234, lvc = -5.06663e-05, lq = 0.000165252, </span></span>
<span><span class="co">#&gt;             lvp = 0.00121347)</span></span>
<span><span class="co">#&gt;         prop.sd ~ c(lcl = 5.2783e-08, lvc = -1.56562e-05, lq = 5.99331e-06, </span></span>
<span><span class="co">#&gt;             lvp = -2.53991e-05, prop.sd = 9.94218e-06)</span></span>
<span><span class="co">#&gt;         eps1 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0)</span></span>
<span><span class="co">#&gt;         eta.cl ~ c(lcl = -4.71273e-05, lvc = 4.69667e-05, lq = -3.64271e-05, </span></span>
<span><span class="co">#&gt;             lvp = 2.54796e-05, prop.sd = -8.16885e-06, eps1 = 0, </span></span>
<span><span class="co">#&gt;             eta.cl = 0.000169296)</span></span>
<span><span class="co">#&gt;         omega.2.1 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0)</span></span>
<span><span class="co">#&gt;         eta.vc ~ c(lcl = -7.37156e-05, lvc = 2.56634e-05, lq = -8.08349e-05, </span></span>
<span><span class="co">#&gt;             lvp = 1.37e-05, prop.sd = -4.36564e-06, eps1 = 0, </span></span>
<span><span class="co">#&gt;             eta.cl = 8.75181e-06, omega.2.1 = 0, eta.vc = 0.00015125)</span></span>
<span><span class="co">#&gt;         omega.3.1 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0, eta.vc = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.3.2 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0, eta.vc = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0)</span></span>
<span><span class="co">#&gt;         eta.q ~ c(lcl = 6.63383e-05, lvc = -8.19002e-05, lq = 0.000548985, </span></span>
<span><span class="co">#&gt;             lvp = 0.000168356, prop.sd = 1.59122e-06, eps1 = 0, </span></span>
<span><span class="co">#&gt;             eta.cl = 3.48714e-05, omega.2.1 = 0, eta.vc = 4.31593e-07, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta.q = 0.000959029)</span></span>
<span><span class="co">#&gt;         omega.4.1 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0, eta.vc = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta.q = 0, omega.4.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.2 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0, eta.vc = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta.q = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.3 ~ c(lcl = 0, lvc = 0, lq = 0, lvp = 0, prop.sd = 0, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta.cl = 0, omega.2.1 = 0, eta.vc = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta.q = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0, omega.4.3 = 0)</span></span>
<span><span class="co">#&gt;         eta.vp ~ c(lcl = -9.49661e-06, lvc = 0.000110108, lq = -0.000306537, </span></span>
<span><span class="co">#&gt;             lvp = -9.12897e-05, prop.sd = 3.1877e-06, eps1 = 0, </span></span>
<span><span class="co">#&gt;             eta.cl = 1.36628e-05, omega.2.1 = 0, eta.vc = -1.95096e-05, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta.q = -0.00012977, </span></span>
<span><span class="co">#&gt;             omega.4.1 = 0, omega.4.2 = 0, omega.4.3 = 0, eta.vp = 0.00051019)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.43e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.19e-05, 0.0418); atol=0.00167", </span></span>
<span><span class="co">#&gt;         "IWRES relative difference compared to Nonmem IWRES: 0%; 95% percentile: (0%,0.01%); rtol=8.99e-06", </span></span>
<span><span class="co">#&gt;         "IWRES absolute difference compared to Nonmem IWRES: 95% percentile: (1.82e-07, 4.63e-05); atol=3.65e-06", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.41e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (1.41e-07,0.00382) atol=6.41e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         lcl &lt;- 1.37034036528946</span></span>
<span><span class="co">#&gt;         label("log Cl")</span></span>
<span><span class="co">#&gt;         lvc &lt;- 4.19814911033061</span></span>
<span><span class="co">#&gt;         label("log Vc")</span></span>
<span><span class="co">#&gt;         lq &lt;- 1.38003493562413</span></span>
<span><span class="co">#&gt;         label("log Q")</span></span>
<span><span class="co">#&gt;         lvp &lt;- 3.87657341967489</span></span>
<span><span class="co">#&gt;         label("log Vp")</span></span>
<span><span class="co">#&gt;         prop.sd &lt;- c(0, 0.196446108190896, 1)</span></span>
<span><span class="co">#&gt;         label("RSV")</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.101251418415006</span></span>
<span><span class="co">#&gt;         eta.vc ~ 0.0993872449483344</span></span>
<span><span class="co">#&gt;         eta.q ~ 0.101302674763154</span></span>
<span><span class="co">#&gt;         eta.vp ~ 0.0730497519364148</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(central)</span></span>
<span><span class="co">#&gt;         cmt(perip)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(lcl + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(lvc + eta.vc)</span></span>
<span><span class="co">#&gt;         q &lt;- exp(lq + eta.q)</span></span>
<span><span class="co">#&gt;         v2 &lt;- exp(lvp + eta.vp)</span></span>
<span><span class="co">#&gt;         v1 &lt;- v</span></span>
<span><span class="co">#&gt;         scale1 &lt;- v</span></span>
<span><span class="co">#&gt;         k21 &lt;- q/v2</span></span>
<span><span class="co">#&gt;         k12 &lt;- q/v</span></span>
<span><span class="co">#&gt;         d/dt(central) &lt;- k21 * perip - k12 * central - cl * central/v1</span></span>
<span><span class="co">#&gt;         d/dt(perip) &lt;- -k21 * perip + k12 * central</span></span>
<span><span class="co">#&gt;         f &lt;- central/scale1</span></span>
<span><span class="co">#&gt;         ipred &lt;- f</span></span>
<span><span class="co">#&gt;         rescv &lt;- prop.sd</span></span>
<span><span class="co">#&gt;         ipred ~ prop(prop.sd)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<p>This checks the parameter names to make sure they are the same length
as the input names, if they are not, the model will skip parameter
renaming and keep the default translation names <code>theta#</code> and
<code>eta#</code>.</p>
<p>As a note, <code>sigma</code> parameters are not currently renamed;
So for the following model (which grabs the parameter automatically
labels to generate variables), <code>sigma</code> is simply
<code>eps#</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"Theopd.ctl"</span>, package<span class="op">=</span><span class="st">"nonmem2rx"</span><span class="op">)</span>, save<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  '/home/runner/work/_temp/Library/nonmem2rx/Theopd.ctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> seeing if file argument is actually lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> not list file, control stream</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $gTHETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PRED</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> final parameters not updated, will skip validation</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based Pred model</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;   POP_E0 POP_EMAX  POP_C50 </span></span>
<span><span class="co">#&gt;      150      200       10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;          PPV_E0 PPV_EMAX PPV_C50</span></span>
<span><span class="co">#&gt; PPV_E0      0.5      0.0     0.0</span></span>
<span><span class="co">#&gt; PPV_EMAX    0.0      0.5     0.0</span></span>
<span><span class="co">#&gt; PPV_C50     0.0      0.0     0.5</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "theophylline pharmacodynamics standard control stream"</span></span>
<span><span class="co">#&gt;     sigma &lt;- lotri({</span></span>
<span><span class="co">#&gt;         eps1 ~ 100</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- "final parameters not updated, validation skipped"</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         POP_E0 &lt;- c(0, 150)</span></span>
<span><span class="co">#&gt;         label("POP_E0 1")</span></span>
<span><span class="co">#&gt;         POP_EMAX &lt;- c(0, 200)</span></span>
<span><span class="co">#&gt;         label("POP_EMAX 2")</span></span>
<span><span class="co">#&gt;         POP_C50 &lt;- c(0.001, 10)</span></span>
<span><span class="co">#&gt;         label("POP_C50 3")</span></span>
<span><span class="co">#&gt;         PPV_E0 ~ 0.5</span></span>
<span><span class="co">#&gt;         PPV_EMAX ~ 0.5</span></span>
<span><span class="co">#&gt;         PPV_C50 ~ 0.5</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         e0 &lt;- POP_E0 * exp(PPV_E0)</span></span>
<span><span class="co">#&gt;         emax &lt;- POP_EMAX * exp(PPV_EMAX)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- POP_C50 * exp(PPV_C50)</span></span>
<span><span class="co">#&gt;         y &lt;- e0 + emax * THEO/(THEO + ec50) + eps1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Sigma</span> (<span style="color: #0000BB; font-weight: bold;">$sigma</span>): </span></span>
<span><span class="co">#&gt;      eps1</span></span>
<span><span class="co">#&gt; eps1  100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<p>You can still rename however you wish, though, using model piping
(<code><a href="https://nlmixr2.github.io/rxode2/reference/rxRename.html" class="external-link">rxRename()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">dplyr::rename()</a></code> would both
work):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxRename.html" class="external-link">rxRename</a></span><span class="op">(</span>add.var<span class="op">=</span><span class="va">eps1</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based Pred model</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;   POP_E0 POP_EMAX  POP_C50 </span></span>
<span><span class="co">#&gt;      150      200       10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;          PPV_E0 PPV_EMAX PPV_C50</span></span>
<span><span class="co">#&gt; PPV_E0      0.5      0.0     0.0</span></span>
<span><span class="co">#&gt; PPV_EMAX    0.0      0.5     0.0</span></span>
<span><span class="co">#&gt; PPV_C50     0.0      0.0     0.5</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "theophylline pharmacodynamics standard control stream"</span></span>
<span><span class="co">#&gt;     sigma &lt;- lotri({</span></span>
<span><span class="co">#&gt;         add.var ~ 100</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- "final parameters not updated, validation skipped"</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         POP_E0 &lt;- c(0, 150)</span></span>
<span><span class="co">#&gt;         label("POP_E0 1")</span></span>
<span><span class="co">#&gt;         POP_EMAX &lt;- c(0, 200)</span></span>
<span><span class="co">#&gt;         label("POP_EMAX 2")</span></span>
<span><span class="co">#&gt;         POP_C50 &lt;- c(0.001, 10)</span></span>
<span><span class="co">#&gt;         label("POP_C50 3")</span></span>
<span><span class="co">#&gt;         PPV_E0 ~ 0.5</span></span>
<span><span class="co">#&gt;         PPV_EMAX ~ 0.5</span></span>
<span><span class="co">#&gt;         PPV_C50 ~ 0.5</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         e0 &lt;- POP_E0 * exp(PPV_E0)</span></span>
<span><span class="co">#&gt;         emax &lt;- POP_EMAX * exp(PPV_EMAX)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- POP_C50 * exp(PPV_C50)</span></span>
<span><span class="co">#&gt;         y &lt;- e0 + emax * THEO/(THEO + ec50) + add.var</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Sigma</span> (<span style="color: #0000BB; font-weight: bold;">$sigma</span>): </span></span>
<span><span class="co">#&gt;         add.var</span></span>
<span><span class="co">#&gt; add.var     100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<p>This model does not specify the residuals in a way that makes sense
to <code>nlmixr2</code>. If you want, you can still <a href="https://nlmixr2.github.io/nonmem2rx/articles/convert-nlmixr2.html" class="external-link">convert
the <code>rxode2</code> model to a nlmixr2 fit</a>.</p>
</div>
<div class="section level2">
<h2 id="technical-details-about-reading-nonmem-to-rxode2">Technical details about reading NONMEM to rxode2<a class="anchor" aria-label="anchor" href="#technical-details-about-reading-nonmem-to-rxode2"></a>
</h2>
<p>The key files to import are the NONMEM control stream (or related
file) and the NONMEM output (often with a <code>.lst</code> or
<code>.res</code> extension).</p>
<p>The import process steps are below:</p>
<ul>
<li><p>Read in the nonmem control stream and convert the model to a
<code>rxode2</code> ui function.</p></li>
<li><p>Try to determine an endpoint/residual specification in the model
(if possible), and convert to a fully qualified ui model that can be
used in <code>nlmixr2</code> and <code>rxode2</code>. If it cannot be
determined automatically, <a href="https://nlmixr2.github.io/nonmem2rx/articles/convert-nlmixr2.html" class="external-link">you
can manually fix this</a> and still convert to a <code>nlmixr2</code>
object (if the data/estimates are available of course).</p></li>
<li><p>If available, <code>nonmem2rx</code> will read the final
parameter estimates and update the model.</p></li>
<li><p>The converter will read in the nonmem input dataset, and search
for the output files with <code>IPRED</code>, <code>PRED</code> and the
<code>ETA</code> values. The translated <code>rxode2</code> model is run
for the population parameters and the individual parameters. This will
then compare the results between <code>NONMEM</code> and
<code>rxode2</code> to make sure the translation makes sense. This only
works when <code>nonmem2rx</code> has access to the input data and the
output with the <code>IWRES</code>, <code>IPRED</code>,
<code>PRED</code> and the <code>ETA</code> values.</p></li>
<li><p>Converts the upper case NONMEM variables to lower case (can be
turned off with <code>nonmem2rx(..., toLowerLhs=FALSE))</code>)</p></li>
<li><p>Replaces the NONMEM theta / eta names with the label-based names
like an extended control stream (can be turned off with
<code>nonmem2rx(thetaNames=FALSE, etaNames=FALSE)</code>)</p></li>
<li><p>Replaces the compartment names with the defined compartment names
in the control stream (ie <code>COMP=(compartmenName)</code>)</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
