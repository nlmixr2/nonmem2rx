<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Converting a NONMEM fit to a nlmixr2 object • nonmem2rx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Converting a NONMEM fit to a nlmixr2 object">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nonmem2rx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-converting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-arrow-right"></span> Converting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-converting">
<li><a class="dropdown-item" href="../articles/import-nonmem.html">Converting NONMEM to rxode2 model</a></li>
    <li><a class="dropdown-item" href="../articles/convert-nlmixr2.html">Converting NONMEM to nlmixr2 object</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/rxode2-validate.html"><span class="fa fa-check"></span> Qualify</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-dice"></span> Simulation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulation">
<li><a class="dropdown-item" href="../articles/simulate-new-dosing.html">New Dosing Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-uncertainty.html">Simulating with Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-extra-items.html">Simulating with Derived Variables</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-new-dosing-with-covs.html">Simulating with Covariates/Input PK parameters</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reporting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reporting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reporting">
<li><a class="dropdown-item" href="../articles/create-office.html">Creating word and powerpoint documents</a></li>
    <li><a class="dropdown-item" href="../articles/create-vpc.html">Easily create VPC plots</a></li>
    <li><a class="dropdown-item" href="../articles/create-augPred.html">Create enriched Individual plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/read-rounding.html"><span class="fa fa-bug"></span> Debug</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-rss"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nonmem2rx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Converting a NONMEM fit to a nlmixr2 object</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nonmem2rx/blob/v0.1.7/vignettes/articles/convert-nlmixr2.Rmd" class="external-link"><code>vignettes/articles/convert-nlmixr2.Rmd</code></a></small>
      <div class="d-none name"><code>convert-nlmixr2.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="creating-a-nlmixr2-compatible-model">Creating a nlmixr2 compatible model<a class="anchor" aria-label="anchor" href="#creating-a-nlmixr2-compatible-model"></a>
</h3>
<p>Depending on the model, not all the residual specifications are
translated to the <code>nlmixr2</code> style residuals. This means the
model cannot be immediately used for either <code><a href="https://nlmixr2.github.io/nlmixr2est/reference/nlmixr2.html" class="external-link">nlmixr2()</a></code>
estimation or creating a <code>nlmixr2</code> fit object (though you can
simulate with and without certainty without any modifications)</p>
<p>For example you could have something like:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">ipred</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">eps1</span><span class="op">)</span></span></code></pre></div>
<p>For a model that can do <code>nlmixr2</code> estimation instead of
simply simulation the residual needs to be changed to something
like:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.sd</span><span class="op">)</span></span></code></pre></div>
<p>Since the model when import has most of the translation done already,
you can easily tweak the model to have this form.</p>
<p>Here is the same example where the residual errors are not
automatically translated to the <code>nlmixr2</code> parameter style (in
this case because of the option <code>determineError=FALSE</code>)</p>
</div>
<div class="section level2">
<h2 id="example-no-error-determined">Example – no error determined<a class="anchor" aria-label="anchor" href="#example-no-error-determined"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nonmem2rx/" class="external-link">nonmem2rx</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/babelmixr2/" class="external-link">babelmixr2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First we need the location of the nonmem control stream Since we are running an example, we will use one of the built-in examples in `nonmem2rx`</span></span>
<span><span class="va">ctlFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"mods/cpt/runODE032.ctl"</span>, package<span class="op">=</span><span class="st">"nonmem2rx"</span><span class="op">)</span></span>
<span><span class="co"># You can use a control stream or other file. With the development</span></span>
<span><span class="co"># version of `babelmixr2`, you can simply point to the listing file</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="va">ctlFile</span>, lst<span class="op">=</span><span class="st">".res"</span>, save<span class="op">=</span><span class="cn">FALSE</span>, determineError<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  '/home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.ctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in xml file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in ext file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in phi file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> abbreviated list parsing</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in grd file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $MODEL</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $gTHETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SUBROUTINES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PK</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ERROR</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta1` to `1.37034036528946`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta2` to `4.19814911033061`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta3` to `1.38003493562413`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta4` to `3.87657341967489`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta5` to `0.196446108190896`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta1` to `0.101251418415006`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta2` to `0.0993872449483344`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta3` to `0.101302674763154`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta4` to `0.0730497519364148`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem input data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/Bolus_2CPT.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> ignoring lines that begin with a letter (IGNORE=@)'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> applying names specified by $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> subsetting accept/ignore filters code: .data[-which((.data$SD == 0)),]</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem IPRED data (for model validation): /home/runner/work/_temp/Library/nonmem2rx/mods/cpt/runODE032.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done (no labels)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming compartments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 2-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;    theta1    theta2    theta3    theta4       RSV </span></span>
<span><span class="co">#&gt; 1.3703404 4.1981491 1.3800349 3.8765734 0.1964461 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;           eta1       eta2      eta3       eta4</span></span>
<span><span class="co">#&gt; eta1 0.1012514 0.00000000 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta2 0.0000000 0.09938724 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta3 0.0000000 0.00000000 0.1013027 0.00000000</span></span>
<span><span class="co">#&gt; eta4 0.0000000 0.00000000 0.0000000 0.07304975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1          CENTRAL</span></span>
<span><span class="co">#&gt; 2                  2             PERI</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;    theta  eta level</span></span>
<span><span class="co">#&gt; 1 theta1 eta1    id</span></span>
<span><span class="co">#&gt; 2 theta2 eta2    id</span></span>
<span><span class="co">#&gt; 3 theta3 eta3    id</span></span>
<span><span class="co">#&gt; 4 theta4 eta4    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "BOLUS_2CPT_CLV1QV2 SINGLE DOSE FOCEI (120 Ind/2280 Obs) runODE032"</span></span>
<span><span class="co">#&gt;     dfObs &lt;- 2280</span></span>
<span><span class="co">#&gt;     dfSub &lt;- 120</span></span>
<span><span class="co">#&gt;     sigma &lt;- lotri({</span></span>
<span><span class="co">#&gt;         eps1 ~ 1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     thetaMat &lt;- lotri({</span></span>
<span><span class="co">#&gt;         theta1 ~ c(theta1 = 0.000887681)</span></span>
<span><span class="co">#&gt;         theta2 ~ c(theta1 = -0.00010551, theta2 = 0.000871409)</span></span>
<span><span class="co">#&gt;         theta3 ~ c(theta1 = 0.000184416, theta2 = -0.000106195, </span></span>
<span><span class="co">#&gt;             theta3 = 0.00299336)</span></span>
<span><span class="co">#&gt;         theta4 ~ c(theta1 = -0.000120234, theta2 = -5.06663e-05, </span></span>
<span><span class="co">#&gt;             theta3 = 0.000165252, theta4 = 0.00121347)</span></span>
<span><span class="co">#&gt;         RSV ~ c(theta1 = 5.2783e-08, theta2 = -1.56562e-05, theta3 = 5.99331e-06, </span></span>
<span><span class="co">#&gt;             theta4 = -2.53991e-05, RSV = 9.94218e-06)</span></span>
<span><span class="co">#&gt;         eps1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0)</span></span>
<span><span class="co">#&gt;         eta1 ~ c(theta1 = -4.71273e-05, theta2 = 4.69667e-05, </span></span>
<span><span class="co">#&gt;             theta3 = -3.64271e-05, theta4 = 2.54796e-05, RSV = -8.16885e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 0.000169296)</span></span>
<span><span class="co">#&gt;         omega.2.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0)</span></span>
<span><span class="co">#&gt;         eta2 ~ c(theta1 = -7.37156e-05, theta2 = 2.56634e-05, </span></span>
<span><span class="co">#&gt;             theta3 = -8.08349e-05, theta4 = 1.37e-05, RSV = -4.36564e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 8.75181e-06, omega.2.1 = 0, eta2 = 0.00015125)</span></span>
<span><span class="co">#&gt;         omega.3.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.3.2 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0)</span></span>
<span><span class="co">#&gt;         eta3 ~ c(theta1 = 6.63383e-05, theta2 = -8.19002e-05, </span></span>
<span><span class="co">#&gt;             theta3 = 0.000548985, theta4 = 0.000168356, RSV = 1.59122e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 3.48714e-05, omega.2.1 = 0, eta2 = 4.31593e-07, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0.000959029)</span></span>
<span><span class="co">#&gt;         omega.4.1 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.2 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0)</span></span>
<span><span class="co">#&gt;         omega.4.3 ~ c(theta1 = 0, theta2 = 0, theta3 = 0, theta4 = 0, </span></span>
<span><span class="co">#&gt;             RSV = 0, eps1 = 0, eta1 = 0, omega.2.1 = 0, eta2 = 0, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = 0, omega.4.1 = 0, </span></span>
<span><span class="co">#&gt;             omega.4.2 = 0, omega.4.3 = 0)</span></span>
<span><span class="co">#&gt;         eta4 ~ c(theta1 = -9.49661e-06, theta2 = 0.000110108, </span></span>
<span><span class="co">#&gt;             theta3 = -0.000306537, theta4 = -9.12897e-05, RSV = 3.1877e-06, </span></span>
<span><span class="co">#&gt;             eps1 = 0, eta1 = 1.36628e-05, omega.2.1 = 0, eta2 = -1.95096e-05, </span></span>
<span><span class="co">#&gt;             omega.3.1 = 0, omega.3.2 = 0, eta3 = -0.00012977, </span></span>
<span><span class="co">#&gt;             omega.4.1 = 0, omega.4.2 = 0, omega.4.3 = 0, eta4 = 0.00051019)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.43e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.19e-05, 0.0418); atol=0.00167", </span></span>
<span><span class="co">#&gt;         "IWRES relative difference compared to Nonmem IWRES: 0%; 95% percentile: (0%,0.01%); rtol=8.99e-06", </span></span>
<span><span class="co">#&gt;         "IWRES absolute difference compared to Nonmem IWRES: 95% percentile: (1.82e-07, 4.63e-05); atol=3.65e-06", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.41e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (1.41e-07,0.00382) atol=6.41e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         theta1 &lt;- 1.37034036528946</span></span>
<span><span class="co">#&gt;         label("log Cl")</span></span>
<span><span class="co">#&gt;         theta2 &lt;- 4.19814911033061</span></span>
<span><span class="co">#&gt;         label("log Vc")</span></span>
<span><span class="co">#&gt;         theta3 &lt;- 1.38003493562413</span></span>
<span><span class="co">#&gt;         label("log Q")</span></span>
<span><span class="co">#&gt;         theta4 &lt;- 3.87657341967489</span></span>
<span><span class="co">#&gt;         label("log Vp")</span></span>
<span><span class="co">#&gt;         RSV &lt;- c(0, 0.196446108190896, 1)</span></span>
<span><span class="co">#&gt;         label("RSV")</span></span>
<span><span class="co">#&gt;         eta1 ~ 0.101251418415006</span></span>
<span><span class="co">#&gt;         eta2 ~ 0.0993872449483344</span></span>
<span><span class="co">#&gt;         eta3 ~ 0.101302674763154</span></span>
<span><span class="co">#&gt;         eta4 ~ 0.0730497519364148</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(CENTRAL)</span></span>
<span><span class="co">#&gt;         cmt(PERI)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(theta1 + eta1)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(theta2 + eta2)</span></span>
<span><span class="co">#&gt;         q &lt;- exp(theta3 + eta3)</span></span>
<span><span class="co">#&gt;         v2 &lt;- exp(theta4 + eta4)</span></span>
<span><span class="co">#&gt;         v1 &lt;- v</span></span>
<span><span class="co">#&gt;         scale1 &lt;- v</span></span>
<span><span class="co">#&gt;         k21 &lt;- q/v2</span></span>
<span><span class="co">#&gt;         k12 &lt;- q/v</span></span>
<span><span class="co">#&gt;         d/dt(CENTRAL) &lt;- k21 * PERI - k12 * CENTRAL - cl * CENTRAL/v1</span></span>
<span><span class="co">#&gt;         d/dt(PERI) &lt;- -k21 * PERI + k12 * CENTRAL</span></span>
<span><span class="co">#&gt;         f &lt;- CENTRAL/scale1</span></span>
<span><span class="co">#&gt;         ipred &lt;- f</span></span>
<span><span class="co">#&gt;         rescv &lt;- RSV</span></span>
<span><span class="co">#&gt;         w &lt;- ipred * rescv</span></span>
<span><span class="co">#&gt;         ires &lt;- DV - ipred</span></span>
<span><span class="co">#&gt;         iwres &lt;- ires/w</span></span>
<span><span class="co">#&gt;         y &lt;- ipred + w * eps1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx translation notes (</span><span style="color: #0000BB; font-weight: bold;">$notes</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;    • there are duplicate eta names, not renaming duplicate parameters </span></span>
<span><span class="co">#&gt;    • there are duplicate theta names, not renaming duplicate parameters </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Sigma</span> (<span style="color: #0000BB; font-weight: bold;">$sigma</span>): </span></span>
<span><span class="co">#&gt;      eps1</span></span>
<span><span class="co">#&gt; eps1    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<p>One approach to get a nlmixr2 compatible model is to copy the printed
model above and then modify it as needed.</p>
<p>In this case, I will name the parameters to something a bit more
meaningful while keeping the estimates the same:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fl">1.37034036528946</span></span>
<span>    <span class="va">lvc</span> <span class="op">&lt;-</span> <span class="fl">4.19814911033061</span></span>
<span>    <span class="va">lq</span> <span class="op">&lt;-</span> <span class="fl">1.38003493562413</span></span>
<span>    <span class="va">lvp</span> <span class="op">&lt;-</span> <span class="fl">3.87657341967489</span></span>
<span>    <span class="va">RSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.196446108190896</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.101251418415006</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.0993872449483344</span></span>
<span>    <span class="va">eta.q</span> <span class="op">~</span> <span class="fl">0.101302674763154</span></span>
<span>    <span class="va">eta.v2</span> <span class="op">~</span> <span class="fl">0.0730497519364148</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">CENTRAL</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">PERI</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvc</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lq</span> <span class="op">+</span> <span class="va">eta.q</span><span class="op">)</span></span>
<span>    <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvp</span> <span class="op">+</span> <span class="va">eta.v2</span><span class="op">)</span></span>
<span>    <span class="va">v1</span> <span class="op">&lt;-</span> <span class="va">v</span></span>
<span>    <span class="va">scale1</span> <span class="op">&lt;-</span> <span class="va">v</span></span>
<span>    <span class="va">k21</span> <span class="op">&lt;-</span> <span class="va">q</span><span class="op">/</span><span class="va">v2</span></span>
<span>    <span class="va">k12</span> <span class="op">&lt;-</span> <span class="va">q</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">CENTRAL</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">k21</span> <span class="op">*</span> <span class="va">PERI</span> <span class="op">-</span> <span class="va">k12</span> <span class="op">*</span> <span class="va">CENTRAL</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">*</span> <span class="va">CENTRAL</span><span class="op">/</span><span class="va">v1</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">PERI</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">k21</span> <span class="op">*</span> <span class="va">PERI</span> <span class="op">+</span> <span class="va">k12</span> <span class="op">*</span> <span class="va">CENTRAL</span></span>
<span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="va">CENTRAL</span><span class="op">/</span><span class="va">scale1</span></span>
<span>    <span class="va">f</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">RSV</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <code><a href="../reference/as.nonmem2rx.html">as.nonmem2rx()</a></code> function will compare the already
imported rxode2 model function with the model you made some manual
tweaks to:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.nonmem2rx.html">as.nonmem2rx</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> copy 'dfSub' to nonmem2rx model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> copy 'thetaMat' to nonmem2rx model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> copy 'dfObs' to nonmem2rx model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 2-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;       lcl       lvc        lq       lvp       RSV </span></span>
<span><span class="co">#&gt; 1.3703404 4.1981491 1.3800349 3.8765734 0.1964461 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;           eta.cl      eta.v     eta.q     eta.v2</span></span>
<span><span class="co">#&gt; eta.cl 0.1012514 0.00000000 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta.v  0.0000000 0.09938724 0.0000000 0.00000000</span></span>
<span><span class="co">#&gt; eta.q  0.0000000 0.00000000 0.1013027 0.00000000</span></span>
<span><span class="co">#&gt; eta.v2 0.0000000 0.00000000 0.0000000 0.07304975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1          CENTRAL</span></span>
<span><span class="co">#&gt; 2                  2             PERI</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   theta    eta level</span></span>
<span><span class="co">#&gt; 1   lcl eta.cl    id</span></span>
<span><span class="co">#&gt; 2   lvc  eta.v    id</span></span>
<span><span class="co">#&gt; 3    lq  eta.q    id</span></span>
<span><span class="co">#&gt; 4   lvp eta.v2    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- "BOLUS_2CPT_CLV1QV2 SINGLE DOSE FOCEI (120 Ind/2280 Obs) runODE032"</span></span>
<span><span class="co">#&gt;     dfObs &lt;- 2280</span></span>
<span><span class="co">#&gt;     dfSub &lt;- 120</span></span>
<span><span class="co">#&gt;     thetaMat &lt;- lotri({</span></span>
<span><span class="co">#&gt;         lcl ~ c(lcl = 0.000887681)</span></span>
<span><span class="co">#&gt;         lvc ~ c(lcl = -0.00010551, lvc = 0.000871409)</span></span>
<span><span class="co">#&gt;         lq ~ c(lcl = 0.000184416, lvc = -0.000106195, lq = 0.00299336)</span></span>
<span><span class="co">#&gt;         lvp ~ c(lcl = -0.000120234, lvc = -5.06663e-05, lq = 0.000165252, </span></span>
<span><span class="co">#&gt;             lvp = 0.00121347)</span></span>
<span><span class="co">#&gt;         RSV ~ c(lcl = 5.2783e-08, lvc = -1.56562e-05, lq = 5.99331e-06, </span></span>
<span><span class="co">#&gt;             lvp = -2.53991e-05, RSV = 9.94218e-06)</span></span>
<span><span class="co">#&gt;         eta.cl ~ c(lcl = -4.71273e-05, lvc = 4.69667e-05, lq = -3.64271e-05, </span></span>
<span><span class="co">#&gt;             lvp = 2.54796e-05, RSV = -8.16885e-06, eta.cl = 0.000169296)</span></span>
<span><span class="co">#&gt;         eta.v ~ c(lcl = -7.37156e-05, lvc = 2.56634e-05, lq = -8.08349e-05, </span></span>
<span><span class="co">#&gt;             lvp = 1.37e-05, RSV = -4.36564e-06, eta.cl = 8.75181e-06, </span></span>
<span><span class="co">#&gt;             eta.v = 0.00015125)</span></span>
<span><span class="co">#&gt;         eta.q ~ c(lcl = 6.63383e-05, lvc = -8.19002e-05, lq = 0.000548985, </span></span>
<span><span class="co">#&gt;             lvp = 0.000168356, RSV = 1.59122e-06, eta.cl = 3.48714e-05, </span></span>
<span><span class="co">#&gt;             eta.v = 4.31593e-07, eta.q = 0.000959029)</span></span>
<span><span class="co">#&gt;         eta.v2 ~ c(lcl = -9.49661e-06, lvc = 0.000110108, lq = -0.000306537, </span></span>
<span><span class="co">#&gt;             lvp = -9.12897e-05, RSV = 3.1877e-06, eta.cl = 1.36628e-05, </span></span>
<span><span class="co">#&gt;             eta.v = -1.95096e-05, eta.q = -0.00012977, eta.v2 = 0.00051019)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.43e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.19e-05, 0.0418); atol=0.00167", </span></span>
<span><span class="co">#&gt;         "IWRES relative difference compared to Nonmem IWRES: 0%; 95% percentile: (0%,0.01%); rtol=8.99e-06", </span></span>
<span><span class="co">#&gt;         "IWRES absolute difference compared to Nonmem IWRES: 95% percentile: (1.82e-07, 4.63e-05); atol=3.65e-06", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.41e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (1.41e-07,0.00382) atol=6.41e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         lcl &lt;- 1.37034036528946</span></span>
<span><span class="co">#&gt;         lvc &lt;- 4.19814911033061</span></span>
<span><span class="co">#&gt;         lq &lt;- 1.38003493562413</span></span>
<span><span class="co">#&gt;         lvp &lt;- 3.87657341967489</span></span>
<span><span class="co">#&gt;         RSV &lt;- c(0, 0.196446108190896, 1)</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.101251418415006</span></span>
<span><span class="co">#&gt;         eta.v ~ 0.0993872449483344</span></span>
<span><span class="co">#&gt;         eta.q ~ 0.101302674763154</span></span>
<span><span class="co">#&gt;         eta.v2 ~ 0.0730497519364148</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(CENTRAL)</span></span>
<span><span class="co">#&gt;         cmt(PERI)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(lcl + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(lvc + eta.v)</span></span>
<span><span class="co">#&gt;         q &lt;- exp(lq + eta.q)</span></span>
<span><span class="co">#&gt;         v2 &lt;- exp(lvp + eta.v2)</span></span>
<span><span class="co">#&gt;         v1 &lt;- v</span></span>
<span><span class="co">#&gt;         scale1 &lt;- v</span></span>
<span><span class="co">#&gt;         k21 &lt;- q/v2</span></span>
<span><span class="co">#&gt;         k12 &lt;- q/v</span></span>
<span><span class="co">#&gt;         d/dt(CENTRAL) &lt;- k21 * PERI - k12 * CENTRAL - cl * CENTRAL/v1</span></span>
<span><span class="co">#&gt;         d/dt(PERI) &lt;- -k21 * PERI + k12 * CENTRAL</span></span>
<span><span class="co">#&gt;         f &lt;- CENTRAL/scale1</span></span>
<span><span class="co">#&gt;         f ~ prop(RSV)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
<p>In this case the <code>new</code> model qualifies and now has all the
information from the imported nonmem2rx model.</p>
<p>This means you can estimate from the new model knowing it was the
same model specified in NONMEM.</p>
<p>Since <code>iwres</code> is affected by how your specify your
residuals, pay special attention to that validation. If it does not
validate, you may have forgot to translate the NONMEM variance estimate
to the standard deviation estimate required by many estimation
methods.</p>
<div class="section level3">
<h3 id="converting-the-model-to-a-nlmixr2-fit">Converting the model to a nlmixr2 fit<a class="anchor" aria-label="anchor" href="#converting-the-model-to-a-nlmixr2-fit"></a>
</h3>
<p>Once you have a <code><a href="https://nlmixr2.github.io/rxode2/reference/rxode2.html" class="external-link">rxode2()</a></code> model that:</p>
<ul>
<li><p>Qualifies against the NONMEM model,</p></li>
<li><p>Has <code>nlmixr2</code> compatible residuals</p></li>
</ul>
<p>You can then convert it to a <code>nlmixr2</code> fit object with
<code>babelmixr2</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/babelmixr2/" class="external-link">babelmixr2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/babelmixr2/reference/as.nlmixr2.html" class="external-link">as.nlmixr2</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; rxode2 4.0.0 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span><span class="co">#&gt; → Calculating residuals/tables</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 203816</span></span>
<span><span class="co">#&gt; → compress parHistData in nlmixr2 object, save 2176</span></span>
<span></span>
<span><span class="va">fit</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>E</mi><mi>R</mi><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>c</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>v</mi><mi>c</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>q</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>q</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>q</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>v</mi><mi>p</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi><mn>2</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>v</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>v</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mn>21</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mi>q</mi><mrow><mi>v</mi><mn>2</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mn>12</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mi>q</mi><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mn>21</mn></mrow><mo>×</mo><mrow><mi>P</mi><mi>E</mi><mi>R</mi><mi>I</mi></mrow><mo>−</mo><mrow><mi>k</mi><mn>12</mn></mrow><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi></mrow><mo>−</mo><mfrac><mrow><mrow><mi>c</mi><mi>l</mi></mrow><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi></mrow></mrow><mrow><mi>v</mi><mn>1</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>P</mi><mi>E</mi><mi>R</mi><mi>I</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mn>21</mn></mrow><mo>×</mo><mrow><mi>P</mi><mi>E</mi><mi>R</mi><mi>I</mi></mrow><mo>+</mo><mrow><mi>k</mi><mn>12</mn></mrow><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>R</mi><mi>A</mi><mi>L</mi></mrow><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mn>1</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mi>S</mi><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
cmt({CENTRAL}) \\
cmt({PERI}) \\
{cl} &amp; = \exp\left({lcl}+{eta.cl}\right) \\
{v} &amp; = \exp\left({lvc}+{eta.v}\right) \\
{q} &amp; = \exp\left({lq}+{eta.q}\right) \\
{v2} &amp; = \exp\left({lvp}+{eta.v2}\right) \\
{v1} &amp; = {v} \\
{scale1} &amp; = {v} \\
{k21} &amp; = \frac{{q}}{{v2}} \\
{k12} &amp; = \frac{{q}}{{v}} \\
\frac{d \: CENTRAL}{dt} &amp; = {k21} {\times} {PERI}-{k12} {\times} {CENTRAL}-\frac{{cl} {\times} {CENTRAL}}{{v1}} \\
\frac{d \: PERI}{dt} &amp; = -{k21} {\times} {PERI}+{k12} {\times} {CENTRAL} \\
{f} &amp; = \frac{{CENTRAL}}{{scale1}} \\
{f} &amp; \sim prop({RSV})
\end{align*}</annotation></semantics></math></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
