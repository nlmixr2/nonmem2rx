<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nonmem2rx">
<title>Reading rounding from NONMEM • nonmem2rx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reading rounding from NONMEM">
<meta property="og:description" content="nonmem2rx">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nonmem2rx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--converting">
    <span class="fa fa-arrow-right"></span>
     
    Converting
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--converting">
    <a class="dropdown-item" href="../articles/import-nonmem.html">Converting NONMEM to rxode2 model</a>
    <a class="dropdown-item" href="../articles/convert-nlmixr2.html">Converting NONMEM to nlmixr2 object</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/rxode2-validate.html">
    <span class="fa fa-check"></span>
     
    Qualify
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--simulation">
    <span class="fa fa-dice"></span>
     
    Simulation
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--simulation">
    <a class="dropdown-item" href="../articles/simulate-new-dosing.html">New Dosing Scenarios</a>
    <a class="dropdown-item" href="../articles/simulate-uncertainty.html">Simulating with Uncertainty</a>
    <a class="dropdown-item" href="../articles/simulate-extra-items.html">Simulating with Derived Variables</a>
    <a class="dropdown-item" href="../articles/simulate-new-dosing-with-covs.html">Simulating with Covariates/Input PK parameters</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reporting">Reporting</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reporting">
    <a class="dropdown-item" href="../articles/create-office.html">Creating word and powerpoint documents</a>
    <a class="dropdown-item" href="../articles/create-vpc.html">Easily create VPC plots</a>
    <a class="dropdown-item" href="../articles/create-augPred.html">Create enriched Individual plots</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/read-rounding.html">
    <span class="fa fa-bug"></span>
     
    Debug
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fas fa fas fa-rss"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/nonmem2rx/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Reading rounding from NONMEM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nonmem2rx/blob/HEAD/vignettes/articles/read-rounding.Rmd" class="external-link"><code>vignettes/articles/read-rounding.Rmd</code></a></small>
      <div class="d-none name"><code>read-rounding.Rmd</code></div>
    </div>

    
    
<p>One of the things that can be helpful is reading NONMEM with rounding
errors.</p>
<p>For this example we will take some of the test examples from
<code>babelmixr2</code> to translate to show examples of rounding errors
that can be read in to help diagnose what could be happening with the
model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nonmem2rx/" class="external-link">nonmem2rx</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/babelmixr2/" class="external-link">babelmixr2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlmixr2</span></span>
<span><span class="co">#&gt; Loading required package: nlmixr2data</span></span></code></pre></div>
<div class="section level2">
<h2 id="step-1-have-a-nonmem-model-with-rounding-errors-and--phi-or-other-information-about-the-etas">Step 1: Have a NONMEM model with rounding errors (and
<code>.phi</code> or other information about the <code>etas</code>)<a class="anchor" aria-label="anchor" href="#step-1-have-a-nonmem-model-with-rounding-errors-and--phi-or-other-information-about-the-etas"></a>
</h2>
<p>The first step is to load a model with rounding errors using
<code><a href="../reference/nonmem2rx.html">nonmem2rx()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unzip example with rounding error</span></span>
<span><span class="co"># included, but can be accessed with nlmixr2</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># unzip(system.file("tests/testthat/pk.turnover.emax3-nonmem.zip", package="babelmixr2"))</span></span>
<span><span class="co"># Load the model with `nonmem2rx`:</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="st">"pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  'pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in xml file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in phi file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> abbreviated list parsing</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $MODEL</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $THETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SUBROUTINES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PK</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ERROR</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta1` to `6.24053043162953e-07`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta2` to `-3.00642760553675e-06`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta3` to `-2.00405074386117`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta4` to `2.05188410700476`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta5` to `0.0985804613565218`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta6` to `0.511625249037084`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta7` to `6.4184983102259`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta8` to `0.140763261319656`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta9` to `-2.9534704318737`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta10` to `4.57045413136592`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta11` to `3.71714384851537`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta1` to `0.558129815059436`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta2` to `0.558402321309217`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta3` to `0.0785849119252598`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta4` to `0.0508226905750953`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta5` to `5e-05`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta6` to `0.18426809257979`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta7` to `0.0083631531443303`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta8` to `0.00274561514766752`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem input data (for model validation): /home/runner/work/nonmem2rx/nonmem2rx/vignettes/articles/pk.turnover.emax3-nonmem/pk.turnover.emax3.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> ignoring lines that begin with a letter (IGNORE=@)'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> applying names specified by $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming 'dvid' to 'nmdvid'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem IPRED data (for model validation): /home/runner/work/nonmem2rx/nonmem2rx/vignettes/articles/pk.turnover.emax3-nonmem/pk.turnover.emax3.pred</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming compartments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 4-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;          tktr           tka           tcl            tv      prop.err </span></span>
<span><span class="co">#&gt;  6.240530e-07 -3.006428e-06 -2.004051e+00  2.051884e+00  9.858046e-02 </span></span>
<span><span class="co">#&gt;     pkadd.err         temax         tec50         tkout           te0 </span></span>
<span><span class="co">#&gt;  5.116252e-01  6.418498e+00  1.407633e-01 -2.953470e+00  4.570454e+00 </span></span>
<span><span class="co">#&gt;     pdadd.err </span></span>
<span><span class="co">#&gt;  3.717144e+00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;            eta.ktr    eta.ka     eta.cl      eta.v eta.emax  eta.ec50</span></span>
<span><span class="co">#&gt; eta.ktr  0.5581298 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.ka   0.0000000 0.5584023 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.cl   0.0000000 0.0000000 0.07858491 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.v    0.0000000 0.0000000 0.00000000 0.05082269    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.emax 0.0000000 0.0000000 0.00000000 0.00000000    5e-05 0.0000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.1842681</span></span>
<span><span class="co">#&gt; eta.kout 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.e0   0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt;             eta.kout      eta.e0</span></span>
<span><span class="co">#&gt; eta.ktr  0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ka   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.cl   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.v    0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.emax 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.kout 0.008363153 0.000000000</span></span>
<span><span class="co">#&gt; eta.e0   0.000000000 0.002745615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1            DEPOT</span></span>
<span><span class="co">#&gt; 2                  2              GUT</span></span>
<span><span class="co">#&gt; 3                  3           CENTER</span></span>
<span><span class="co">#&gt; 4                  4           EFFECT</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- c("translated from babelmixr2", "; comments show mu referenced model in ui$getSplitMuModel")</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.13e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (3.12e-06, 0.000497); atol=6.17e-05", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.18e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (3.79e-07,0.00313) atol=6.18e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         tktr &lt;- 6.24053043162953e-07</span></span>
<span><span class="co">#&gt;         label("1 - tktr")</span></span>
<span><span class="co">#&gt;         tka &lt;- -3.00642760553675e-06</span></span>
<span><span class="co">#&gt;         label("2 - tka")</span></span>
<span><span class="co">#&gt;         tcl &lt;- -2.00405074386117</span></span>
<span><span class="co">#&gt;         label("3 - tcl")</span></span>
<span><span class="co">#&gt;         tv &lt;- 2.05188410700476</span></span>
<span><span class="co">#&gt;         label("4 - tv")</span></span>
<span><span class="co">#&gt;         prop.err &lt;- c(0, 0.0985804613565218)</span></span>
<span><span class="co">#&gt;         label("5 - prop.err")</span></span>
<span><span class="co">#&gt;         pkadd.err &lt;- c(0, 0.511625249037084)</span></span>
<span><span class="co">#&gt;         label("6 - pkadd.err")</span></span>
<span><span class="co">#&gt;         temax &lt;- 6.4184983102259</span></span>
<span><span class="co">#&gt;         label("7 - temax")</span></span>
<span><span class="co">#&gt;         tec50 &lt;- 0.140763261319656</span></span>
<span><span class="co">#&gt;         label("8 - tec50")</span></span>
<span><span class="co">#&gt;         tkout &lt;- -2.9534704318737</span></span>
<span><span class="co">#&gt;         label("9 - tkout")</span></span>
<span><span class="co">#&gt;         te0 &lt;- 4.57045413136592</span></span>
<span><span class="co">#&gt;         label("10 - te0")</span></span>
<span><span class="co">#&gt;         pdadd.err &lt;- c(0, 3.71714384851537)</span></span>
<span><span class="co">#&gt;         label("11 - pdadd.err")</span></span>
<span><span class="co">#&gt;         eta.ktr ~ 0.558129815059436</span></span>
<span><span class="co">#&gt;         eta.ka ~ 0.558402321309217</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.0785849119252598</span></span>
<span><span class="co">#&gt;         eta.v ~ 0.0508226905750953</span></span>
<span><span class="co">#&gt;         eta.emax ~ 5e-05</span></span>
<span><span class="co">#&gt;         eta.ec50 ~ 0.18426809257979</span></span>
<span><span class="co">#&gt;         eta.kout ~ 0.0083631531443303</span></span>
<span><span class="co">#&gt;         eta.e0 ~ 0.00274561514766752</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(DEPOT)</span></span>
<span><span class="co">#&gt;         cmt(GUT)</span></span>
<span><span class="co">#&gt;         cmt(CENTER)</span></span>
<span><span class="co">#&gt;         cmt(EFFECT)</span></span>
<span><span class="co">#&gt;         mu_1 &lt;- tktr</span></span>
<span><span class="co">#&gt;         mu_2 &lt;- tka</span></span>
<span><span class="co">#&gt;         mu_3 &lt;- tcl</span></span>
<span><span class="co">#&gt;         mu_4 &lt;- tv</span></span>
<span><span class="co">#&gt;         mu_5 &lt;- temax</span></span>
<span><span class="co">#&gt;         mu_6 &lt;- tec50</span></span>
<span><span class="co">#&gt;         mu_7 &lt;- tkout</span></span>
<span><span class="co">#&gt;         mu_8 &lt;- te0</span></span>
<span><span class="co">#&gt;         ktr &lt;- exp(mu_1 + eta.ktr)</span></span>
<span><span class="co">#&gt;         ka &lt;- exp(mu_2 + eta.ka)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(mu_3 + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(mu_4 + eta.v)</span></span>
<span><span class="co">#&gt;         emax &lt;- ((1) - (0)) * (1/(1 + exp(-(mu_5 + eta.emax)))) + </span></span>
<span><span class="co">#&gt;             (0)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- exp(mu_6 + eta.ec50)</span></span>
<span><span class="co">#&gt;         kout &lt;- exp(mu_7 + eta.kout)</span></span>
<span><span class="co">#&gt;         e0 &lt;- exp(mu_8 + eta.e0)</span></span>
<span><span class="co">#&gt;         rxini.rxddta4. &lt;- e0</span></span>
<span><span class="co">#&gt;         EFFECT(0) &lt;- rxini.rxddta4.</span></span>
<span><span class="co">#&gt;         dcp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         rxdz001 &lt;- (ec50 + dcp)</span></span>
<span><span class="co">#&gt;         if (rxdz001 &gt;= 0 &amp;&amp; rxdz001 &lt;= 1e-06) {</span></span>
<span><span class="co">#&gt;             rxdz001 &lt;- 1e-06</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (rxdz001 &gt;= -1e-06 &amp;&amp; rxdz001 &lt; 0) {</span></span>
<span><span class="co">#&gt;             rxdz001 &lt;- -1e-06</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         pd &lt;- 1 - emax * dcp/rxdz001</span></span>
<span><span class="co">#&gt;         kin &lt;- e0 * kout</span></span>
<span><span class="co">#&gt;         d/dt(DEPOT) &lt;- -ktr * DEPOT</span></span>
<span><span class="co">#&gt;         d/dt(GUT) &lt;- ktr * DEPOT - ka * GUT</span></span>
<span><span class="co">#&gt;         d/dt(CENTER) &lt;- ka * GUT - cl/v * CENTER</span></span>
<span><span class="co">#&gt;         d/dt(EFFECT) &lt;- kin * pd - kout * EFFECT</span></span>
<span><span class="co">#&gt;         cp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         f &lt;- DEPOT</span></span>
<span><span class="co">#&gt;         rxe_dcp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         rxdze001 &lt;- (ec50 + rxe_dcp)</span></span>
<span><span class="co">#&gt;         if (rxdze001 &gt;= 0 &amp;&amp; rxdze001 &lt;= 1e-06) {</span></span>
<span><span class="co">#&gt;             rxdze001 &lt;- 1e-06</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (rxdze001 &gt;= -1e-06 &amp;&amp; rxdze001 &lt; 0) {</span></span>
<span><span class="co">#&gt;             rxdze001 &lt;- -1e-06</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         rxe_pd &lt;- 1 - emax * rxe_dcp/rxdze001</span></span>
<span><span class="co">#&gt;         rxe_kin &lt;- e0 * kout</span></span>
<span><span class="co">#&gt;         rxe_cp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         rx_pf1 &lt;- rxe_cp</span></span>
<span><span class="co">#&gt;         rx_pf2 &lt;- EFFECT</span></span>
<span><span class="co">#&gt;         rx_ip1 &lt;- rx_pf1</span></span>
<span><span class="co">#&gt;         rx_p1 &lt;- rx_ip1</span></span>
<span><span class="co">#&gt;         w1 &lt;- sqrt((pkadd.err)^2 + (rx_pf1)^2 * (prop.err)^2)</span></span>
<span><span class="co">#&gt;         if (w1 == 0) </span></span>
<span><span class="co">#&gt;             w1 &lt;- 1</span></span>
<span><span class="co">#&gt;         rx_ip2 &lt;- rx_pf2</span></span>
<span><span class="co">#&gt;         rx_p2 &lt;- rx_ip2</span></span>
<span><span class="co">#&gt;         w2 &lt;- sqrt((pdadd.err)^2)</span></span>
<span><span class="co">#&gt;         if (w2 == 0) </span></span>
<span><span class="co">#&gt;             w2 &lt;- 1</span></span>
<span><span class="co">#&gt;         ipred &lt;- rx_ip1</span></span>
<span><span class="co">#&gt;         w &lt;- w1</span></span>
<span><span class="co">#&gt;         if (nmdvid == 2) {</span></span>
<span><span class="co">#&gt;             ipred &lt;- rx_ip2</span></span>
<span><span class="co">#&gt;             w &lt;- w2</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         y &lt;- ipred + w * eps1</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx translation notes (</span><span style="color: #0000BB; font-weight: bold;">$notes</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;    • some etas defaulted to non-mu referenced, possible parsing error: eta.emax as a work-around try putting the mu-referenced expression on a simple line </span></span>
<span><span class="co">#&gt;    • some etas defaulted to non-mu referenced, possible parsing error: eta5 as a work-around try putting the mu-referenced expression on a simple line </span></span>
<span><span class="co">#&gt;    • some NONMEM input has tied times; they are offset by a small offset </span></span>
<span><span class="co">#&gt;    • is.na() applied to non-(list or vector) of type 'language' </span></span>
<span><span class="co">#&gt;    • 'dvid' variable has special meaning in rxode2, renamed to 'nmdvid', rename/copy in your data too </span></span>
<span><span class="co">#&gt;    • $MODEL NCOMPARTMENTS/NEQUILIBRIUM/NPARAMETERS statement(s) ignored </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Sigma</span> (<span style="color: #0000BB; font-weight: bold;">$sigma</span>): </span></span>
<span><span class="co">#&gt;      eps1</span></span>
<span><span class="co">#&gt; eps1    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span>, <span style="color: #0000BB; font-weight: bold;">$dfSub</span>, <span style="color: #0000BB; font-weight: bold;">$dfObs</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-2-convert-rxode2-model-to-model-with-endpointsresiduals-specified-like-nlmixr2">Step 2: Convert <code>rxode2</code> model to model with
endpoints/residuals specified like <code>nlmixr2</code><a class="anchor" aria-label="anchor" href="#step-2-convert-rxode2-model-to-model-with-endpointsresiduals-specified-like-nlmixr2"></a>
</h2>
<p>This example has rounding errors and isn’t a fully qualified
<code>nlmixr2</code> model (even though it was generated from
<code>nlmixr2</code>).</p>
<p>We can use the model and create an equivalent model with
<code><a href="../reference/as.nonmem2rx.html">as.nonmem2rx()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tktr</span> <span class="op">&lt;-</span> <span class="fl">6.24053043162953e-07</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"1 - tktr"</span><span class="op">)</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3.00642760553675e-06</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"2 - tka"</span><span class="op">)</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.00405074386117</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"3 - tcl"</span><span class="op">)</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">2.05188410700476</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"4 - tv"</span><span class="op">)</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.0985804613565218</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"5 - prop.err"</span><span class="op">)</span></span>
<span>    <span class="va">pkadd.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.511625249037084</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"6 - pkadd.err"</span><span class="op">)</span></span>
<span>    <span class="va">temax</span> <span class="op">&lt;-</span> <span class="fl">6.4184983102259</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"7 - temax"</span><span class="op">)</span></span>
<span>    <span class="va">tec50</span> <span class="op">&lt;-</span> <span class="fl">0.140763261319656</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"8 - tec50"</span><span class="op">)</span></span>
<span>    <span class="va">tkout</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.9534704318737</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"9 - tkout"</span><span class="op">)</span></span>
<span>    <span class="va">te0</span> <span class="op">&lt;-</span> <span class="fl">4.57045413136592</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"10 - te0"</span><span class="op">)</span></span>
<span>    <span class="va">pdadd.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.71714384851537</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"11 - pdadd.err"</span><span class="op">)</span></span>
<span>    <span class="va">eta.ktr</span> <span class="op">~</span> <span class="fl">0.558129815059436</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.558402321309217</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.0785849119252598</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.0508226905750953</span></span>
<span>    <span class="va">eta.emax</span> <span class="op">~</span> <span class="fl">5e-05</span></span>
<span>    <span class="va">eta.ec50</span> <span class="op">~</span> <span class="fl">0.18426809257979</span></span>
<span>    <span class="va">eta.kout</span> <span class="op">~</span> <span class="fl">0.0083631531443303</span></span>
<span>    <span class="va">eta.e0</span> <span class="op">~</span> <span class="fl">0.00274561514766752</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">DEPOT</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">GUT</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">CENTER</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">EFFECT</span><span class="op">)</span></span>
<span>    <span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span> <span class="op">+</span> <span class="va">eta.ktr</span><span class="op">)</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span>   <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span>   <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span>     <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">emax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/logit.html" class="external-link">expit</a></span><span class="op">(</span><span class="va">temax</span> <span class="op">+</span> <span class="va">eta.emax</span><span class="op">)</span> </span>
<span>    <span class="va">ec50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tec50</span> <span class="op">+</span> <span class="va">eta.ec50</span><span class="op">)</span></span>
<span>    <span class="va">kout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span> <span class="op">+</span> <span class="va">eta.kout</span><span class="op">)</span></span>
<span>    <span class="va">e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">te0</span> <span class="op">+</span> <span class="va">eta.e0</span><span class="op">)</span></span>
<span>    <span class="fu">EFFECT</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">e0</span></span>
<span>    <span class="va">dcp</span> <span class="op">&lt;-</span> <span class="va">CENTER</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">emax</span> <span class="op">*</span> <span class="va">dcp</span><span class="op">/</span><span class="op">(</span><span class="va">ec50</span> <span class="op">+</span> <span class="va">dcp</span><span class="op">)</span></span>
<span>    <span class="va">kin</span> <span class="op">&lt;-</span> <span class="va">e0</span> <span class="op">*</span> <span class="va">kout</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">DEPOT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">ktr</span> <span class="op">*</span> <span class="va">DEPOT</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">GUT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ktr</span> <span class="op">*</span> <span class="va">DEPOT</span> <span class="op">-</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">GUT</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">CENTER</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">GUT</span> <span class="op">-</span> <span class="va">cl</span><span class="op">/</span><span class="va">v</span> <span class="op">*</span> <span class="va">CENTER</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">EFFECT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">kin</span> <span class="op">*</span> <span class="va">pd</span> <span class="op">-</span> <span class="va">kout</span> <span class="op">*</span> <span class="va">EFFECT</span></span>
<span>    <span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">EFFECT</span></span>
<span>    <span class="va">dcp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span><span class="op">+</span><span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span>    <span class="va">eff</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the model above, the following modifications were made:</p>
<ul>
<li><p>The code for protecting for rounding errors was removed</p></li>
<li><p>Endpoints/residual specifications were added</p></li>
<li><p>Duplicate code in NONMEM’s <code>$ERROR</code> block was removed
from imported model</p></li>
<li><p>All the <code>rx</code> and <code>nlmixr</code> prefixed items
were removed from the model. It is possible that not removing these
variables can cause<code>nlmixr2</code> conversion to fail. It is best
practice to remove them completely.</p></li>
</ul>
<p>Also, it is good practice to make sure the model parses correctly
before trying to validate/convert the model. If you find that your model
doesn’t parse correctly it definitely won’t validate (and the error may
not be as easy to track-down).</p>
<p>The first step is to validate if the translation is correct. This is
done below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.nonmem2rx.html">as.nonmem2rx</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> merging 'dvid' with nlmixr2 'cmt' definition</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 4-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;          tktr           tka           tcl            tv      prop.err </span></span>
<span><span class="co">#&gt;  6.240530e-07 -3.006428e-06 -2.004051e+00  2.051884e+00  9.858046e-02 </span></span>
<span><span class="co">#&gt;     pkadd.err         temax         tec50         tkout           te0 </span></span>
<span><span class="co">#&gt;  5.116252e-01  6.418498e+00  1.407633e-01 -2.953470e+00  4.570454e+00 </span></span>
<span><span class="co">#&gt;     pdadd.err </span></span>
<span><span class="co">#&gt;  3.717144e+00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;            eta.ktr    eta.ka     eta.cl      eta.v eta.emax  eta.ec50</span></span>
<span><span class="co">#&gt; eta.ktr  0.5581298 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.ka   0.0000000 0.5584023 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.cl   0.0000000 0.0000000 0.07858491 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.v    0.0000000 0.0000000 0.00000000 0.05082269    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.emax 0.0000000 0.0000000 0.00000000 0.00000000    5e-05 0.0000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.1842681</span></span>
<span><span class="co">#&gt; eta.kout 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.e0   0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt;             eta.kout      eta.e0</span></span>
<span><span class="co">#&gt; eta.ktr  0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ka   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.cl   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.v    0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.emax 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.kout 0.008363153 0.000000000</span></span>
<span><span class="co">#&gt; eta.e0   0.000000000 0.002745615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1            DEPOT</span></span>
<span><span class="co">#&gt; 2                  2              GUT</span></span>
<span><span class="co">#&gt; 3                  3           CENTER</span></span>
<span><span class="co">#&gt; 4                  4           EFFECT</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Multiple Endpoint Model (</span><span style="color: #0000BB; font-weight: bold;">$multipleEndpoint</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   variable                cmt                dvid*</span></span>
<span><span class="co">#&gt; 1  dcp ~ … cmt='dcp' or cmt=5 dvid='dcp' or dvid=1</span></span>
<span><span class="co">#&gt; 2  eff ~ … cmt='eff' or cmt=6 dvid='eff' or dvid=2</span></span>
<span><span class="co">#&gt;   * If dvids are outside this range, all dvids are re-numered sequentially, ie 1,7, 10 becomes 1,2,3 etc</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   theta      eta level</span></span>
<span><span class="co">#&gt; 1  tktr  eta.ktr    id</span></span>
<span><span class="co">#&gt; 2   tka   eta.ka    id</span></span>
<span><span class="co">#&gt; 3   tcl   eta.cl    id</span></span>
<span><span class="co">#&gt; 4    tv    eta.v    id</span></span>
<span><span class="co">#&gt; 5 temax eta.emax    id</span></span>
<span><span class="co">#&gt; 6 tec50 eta.ec50    id</span></span>
<span><span class="co">#&gt; 7 tkout eta.kout    id</span></span>
<span><span class="co">#&gt; 8   te0   eta.e0    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- c("translated from babelmixr2", "; comments show mu referenced model in ui$getSplitMuModel")</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.13e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (3.12e-06, 0.000497); atol=6.17e-05", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.18e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (3.79e-07,0.00313) atol=6.18e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         tktr &lt;- 6.24053043162953e-07</span></span>
<span><span class="co">#&gt;         label("1 - tktr")</span></span>
<span><span class="co">#&gt;         tka &lt;- -3.00642760553675e-06</span></span>
<span><span class="co">#&gt;         label("2 - tka")</span></span>
<span><span class="co">#&gt;         tcl &lt;- -2.00405074386117</span></span>
<span><span class="co">#&gt;         label("3 - tcl")</span></span>
<span><span class="co">#&gt;         tv &lt;- 2.05188410700476</span></span>
<span><span class="co">#&gt;         label("4 - tv")</span></span>
<span><span class="co">#&gt;         prop.err &lt;- c(0, 0.0985804613565218)</span></span>
<span><span class="co">#&gt;         label("5 - prop.err")</span></span>
<span><span class="co">#&gt;         pkadd.err &lt;- c(0, 0.511625249037084)</span></span>
<span><span class="co">#&gt;         label("6 - pkadd.err")</span></span>
<span><span class="co">#&gt;         temax &lt;- 6.4184983102259</span></span>
<span><span class="co">#&gt;         label("7 - temax")</span></span>
<span><span class="co">#&gt;         tec50 &lt;- 0.140763261319656</span></span>
<span><span class="co">#&gt;         label("8 - tec50")</span></span>
<span><span class="co">#&gt;         tkout &lt;- -2.9534704318737</span></span>
<span><span class="co">#&gt;         label("9 - tkout")</span></span>
<span><span class="co">#&gt;         te0 &lt;- 4.57045413136592</span></span>
<span><span class="co">#&gt;         label("10 - te0")</span></span>
<span><span class="co">#&gt;         pdadd.err &lt;- c(0, 3.71714384851537)</span></span>
<span><span class="co">#&gt;         label("11 - pdadd.err")</span></span>
<span><span class="co">#&gt;         eta.ktr ~ 0.558129815059436</span></span>
<span><span class="co">#&gt;         eta.ka ~ 0.558402321309217</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.0785849119252598</span></span>
<span><span class="co">#&gt;         eta.v ~ 0.0508226905750953</span></span>
<span><span class="co">#&gt;         eta.emax ~ 5e-05</span></span>
<span><span class="co">#&gt;         eta.ec50 ~ 0.18426809257979</span></span>
<span><span class="co">#&gt;         eta.kout ~ 0.0083631531443303</span></span>
<span><span class="co">#&gt;         eta.e0 ~ 0.00274561514766752</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(DEPOT)</span></span>
<span><span class="co">#&gt;         cmt(GUT)</span></span>
<span><span class="co">#&gt;         cmt(CENTER)</span></span>
<span><span class="co">#&gt;         cmt(EFFECT)</span></span>
<span><span class="co">#&gt;         ktr &lt;- exp(tktr + eta.ktr)</span></span>
<span><span class="co">#&gt;         ka &lt;- exp(tka + eta.ka)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(tcl + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(tv + eta.v)</span></span>
<span><span class="co">#&gt;         emax &lt;- expit(temax + eta.emax)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- exp(tec50 + eta.ec50)</span></span>
<span><span class="co">#&gt;         kout &lt;- exp(tkout + eta.kout)</span></span>
<span><span class="co">#&gt;         e0 &lt;- exp(te0 + eta.e0)</span></span>
<span><span class="co">#&gt;         EFFECT(0) &lt;- e0</span></span>
<span><span class="co">#&gt;         dcp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         pd &lt;- 1 - emax * dcp/(ec50 + dcp)</span></span>
<span><span class="co">#&gt;         kin &lt;- e0 * kout</span></span>
<span><span class="co">#&gt;         d/dt(DEPOT) &lt;- -ktr * DEPOT</span></span>
<span><span class="co">#&gt;         d/dt(GUT) &lt;- ktr * DEPOT - ka * GUT</span></span>
<span><span class="co">#&gt;         d/dt(CENTER) &lt;- ka * GUT - cl/v * CENTER</span></span>
<span><span class="co">#&gt;         d/dt(EFFECT) &lt;- kin * pd - kout * EFFECT</span></span>
<span><span class="co">#&gt;         eff &lt;- EFFECT</span></span>
<span><span class="co">#&gt;         dcp ~ add(pkadd.err) + prop(prop.err)</span></span>
<span><span class="co">#&gt;         eff ~ add(pdadd.err)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span>, <span style="color: #0000BB; font-weight: bold;">$thetaMat</span>, <span style="color: #0000BB; font-weight: bold;">$dfSub</span>, <span style="color: #0000BB; font-weight: bold;">$dfObs</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-3-convert-new-model-to-nlmixr2-fit-with-as-nlmixr2">Step 3: Convert new model to nlmixr2 fit with
<code>as.nlmixr2()</code><a class="anchor" aria-label="anchor" href="#step-3-convert-new-model-to-nlmixr2-fit-with-as-nlmixr2"></a>
</h2>
<p>Once the translation is complete, and it is validated, you can
convert the fit to a full nlmixr2 fit object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/babelmixr2/reference/as.nlmixr2.html" class="external-link">as.nlmixr2</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; rxode2 2.0.13.9000 using 1 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span><span class="co">#&gt; → Calculating residuals/tables</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span><span class="co">#&gt; → compress parHist in nlmixr2 object, save 4928</span></span>
<span></span>
<span><span class="co"># Once it is loaded remove the directory (we don't need the files any</span></span>
<span><span class="co"># more for this example)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># In this example, we don't remove, but note where it can be removed</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># unlink("pk.turnover.emax3-nonmem", recursive = TRUE)</span></span></code></pre></div>
<p>Note this object <strong>does not</strong> rerun an estimation, but
rather imports everything it knows about the fit to rerun the
<code>nlmixr2</code> table steps to calculate the things you need.</p>
</div>
<div class="section level2">
<h2 id="step-4-explore-the-datafit-as-if-it-came-from-nlmixr2">Step 4: Explore the data/fit as if it came from
<code>nlmixr2</code><a class="anchor" aria-label="anchor" href="#step-4-explore-the-datafit-as-if-it-came-from-nlmixr2"></a>
</h2>
<p>With this information you can see about the properties of the
model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">nonmem2rx</span><span style="font-weight: bold;"> reading NONMEM ver 7.4.3 ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               OBJF     AIC      BIC Log-likelihood</span></span>
<span><span class="co">#&gt; nonmem2rx 439.2156 1364.91 1444.331      -663.4551</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup table compress NONMEM as.nlmixr2</span></span>
<span><span class="co">#&gt; elapsed 0.024159 0.043    0.014 320.27      3.735</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                <span style="font-weight: bold;">Parameter</span>      <span style="font-weight: bold;">Est.</span> <span style="font-weight: bold;">Back-transformed</span> <span style="font-weight: bold;">BSV(CV% or SD)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>            1 - <span style="font-weight: bold;">tktr</span>  6.24e-07                1           86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>              2 - <span style="font-weight: bold;">tka</span> -3.01e-06                1           86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>              3 - <span style="font-weight: bold;">tcl</span>        -2            0.135           28.6      1.34% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>                4 - <span style="font-weight: bold;">tv</span>      2.05             7.78           22.8      6.44% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>    5 - <span style="font-weight: bold;">prop.err</span>    0.0986           0.0986                           </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>  6 - <span style="font-weight: bold;">pkadd.err</span>     0.512            0.512                           </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>          7 - <span style="font-weight: bold;">temax</span>      6.42            0.998           3.00      <span style="color: #BB0000; font-weight: bold;">100.%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>          8 - <span style="font-weight: bold;">tec50</span>     0.141             1.15           45.0      6.06% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>          9 - <span style="font-weight: bold;">tkout</span>     -2.95           0.0522           9.16      <span style="color: #BB0000; font-weight: bold;">32.4%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>             10 - <span style="font-weight: bold;">te0</span>      4.57             96.6           5.24      18.1% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span> 11 - <span style="font-weight: bold;">pdadd.err</span>      3.72             3.72                           </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; 0MINIMIZATION TERMINATED</span></span>
<span><span class="co">#&gt;  DUE TO ROUNDING ERRORS (ERROR=134)</span></span>
<span><span class="co">#&gt;  NO. OF FUNCTION EVALUATIONS USED:     1088</span></span>
<span><span class="co">#&gt;  NO. OF SIG. DIGITS UNREPORTABLE</span></span>
<span><span class="co">#&gt; 0PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=5.09e-06</span></span>
<span><span class="co">#&gt;     PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=5.29e-06</span></span>
<span><span class="co">#&gt;     IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.2e-06, 0.000454); atol=3.03e-05</span></span>
<span><span class="co">#&gt;     PRED absolute difference compared to Nonmem PRED: 95% percentile: (4.72e-07,0.00361); atol=5.29e-06</span></span>
<span><span class="co">#&gt;     there are solving errors during optimization (see '$prderr')</span></span>
<span><span class="co">#&gt;     nonmem2rx model file: 'pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl' </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 483 × 35</span></span></span>
<span><span class="co">#&gt;   ID     TIME CMT      DV  PRED   RES IPRED   IRES  IWRES eta.ktr eta.ka eta.cl</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       0.5 dcp     0    1.16 -<span style="color: #BB0000;">1.16</span> 0.444 -<span style="color: #BB0000;">0.444</span> -<span style="color: #BB0000;">0.864</span>  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       1   dcp     1.9  3.37 -<span style="color: #BB0000;">1.47</span> 1.45   0.446  0.840  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       2   dcp     3.3  7.51 -<span style="color: #BB0000;">4.21</span> 3.96  -<span style="color: #BB0000;">0.660</span> -<span style="color: #BB0000;">1.03</span>   -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 480 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more variables: eta.v &lt;dbl&gt;, eta.emax &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.kout &lt;dbl&gt;, eta.e0 &lt;dbl&gt;, dcp &lt;dbl&gt;, eff &lt;dbl&gt;, DEPOT &lt;dbl&gt;, GUT &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CENTER &lt;dbl&gt;, EFFECT &lt;dbl&gt;, ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;, e0 &lt;dbl&gt;, pd &lt;dbl&gt;, kin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>In this model you can see:</p>
<ul>
<li>High shrinkage in <code>temax</code>, <code>ktr</code>,
<code>ka</code> and moderate shrinkage in <code>kout</code>
</li>
</ul>
<p>By removing these parameters, you could possibly get a successful
NONMEM run.</p>
<p>If you want, you can use model piping to remove these parameters as
follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">&lt;-</span>  <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">emax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/logit.html" class="external-link">expit</a></span><span class="op">(</span><span class="va">temax</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">kout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.ktr`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.ka`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.emax`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.kout`</span></span>
<span></span>
<span><span class="va">mod3</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 4-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;          tktr           tka           tcl            tv      prop.err </span></span>
<span><span class="co">#&gt;  6.240530e-07 -3.006428e-06 -2.004051e+00  2.051884e+00  9.858046e-02 </span></span>
<span><span class="co">#&gt;     pkadd.err         temax         tec50         tkout           te0 </span></span>
<span><span class="co">#&gt;  5.116252e-01  6.418498e+00  1.407633e-01 -2.953470e+00  4.570454e+00 </span></span>
<span><span class="co">#&gt;     pdadd.err </span></span>
<span><span class="co">#&gt;  3.717144e+00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;              eta.cl      eta.v  eta.ec50      eta.e0</span></span>
<span><span class="co">#&gt; eta.cl   0.07858491 0.00000000 0.0000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.v    0.00000000 0.05082269 0.0000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.00000000 0.00000000 0.1842681 0.000000000</span></span>
<span><span class="co">#&gt; eta.e0   0.00000000 0.00000000 0.0000000 0.002745615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1            DEPOT</span></span>
<span><span class="co">#&gt; 2                  2              GUT</span></span>
<span><span class="co">#&gt; 3                  3           CENTER</span></span>
<span><span class="co">#&gt; 4                  4           EFFECT</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Multiple Endpoint Model (</span><span style="color: #0000BB; font-weight: bold;">$multipleEndpoint</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   variable                cmt                dvid*</span></span>
<span><span class="co">#&gt; 1  dcp ~ … cmt='dcp' or cmt=5 dvid='dcp' or dvid=1</span></span>
<span><span class="co">#&gt; 2  eff ~ … cmt='eff' or cmt=6 dvid='eff' or dvid=2</span></span>
<span><span class="co">#&gt;   * If dvids are outside this range, all dvids are re-numered sequentially, ie 1,7, 10 becomes 1,2,3 etc</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   theta      eta level</span></span>
<span><span class="co">#&gt; 1   tcl   eta.cl    id</span></span>
<span><span class="co">#&gt; 2    tv    eta.v    id</span></span>
<span><span class="co">#&gt; 3 tec50 eta.ec50    id</span></span>
<span><span class="co">#&gt; 4   te0   eta.e0    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- c("translated from babelmixr2", "; comments show mu referenced model in ui$getSplitMuModel")</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.13e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (3.12e-06, 0.000497); atol=6.17e-05", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.18e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (3.79e-07,0.00313) atol=6.18e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         tktr &lt;- 6.24053043162953e-07</span></span>
<span><span class="co">#&gt;         label("1 - tktr")</span></span>
<span><span class="co">#&gt;         tka &lt;- -3.00642760553675e-06</span></span>
<span><span class="co">#&gt;         label("2 - tka")</span></span>
<span><span class="co">#&gt;         tcl &lt;- -2.00405074386117</span></span>
<span><span class="co">#&gt;         label("3 - tcl")</span></span>
<span><span class="co">#&gt;         tv &lt;- 2.05188410700476</span></span>
<span><span class="co">#&gt;         label("4 - tv")</span></span>
<span><span class="co">#&gt;         prop.err &lt;- c(0, 0.0985804613565218)</span></span>
<span><span class="co">#&gt;         label("5 - prop.err")</span></span>
<span><span class="co">#&gt;         pkadd.err &lt;- c(0, 0.511625249037084)</span></span>
<span><span class="co">#&gt;         label("6 - pkadd.err")</span></span>
<span><span class="co">#&gt;         temax &lt;- 6.4184983102259</span></span>
<span><span class="co">#&gt;         label("7 - temax")</span></span>
<span><span class="co">#&gt;         tec50 &lt;- 0.140763261319656</span></span>
<span><span class="co">#&gt;         label("8 - tec50")</span></span>
<span><span class="co">#&gt;         tkout &lt;- -2.9534704318737</span></span>
<span><span class="co">#&gt;         label("9 - tkout")</span></span>
<span><span class="co">#&gt;         te0 &lt;- 4.57045413136592</span></span>
<span><span class="co">#&gt;         label("10 - te0")</span></span>
<span><span class="co">#&gt;         pdadd.err &lt;- c(0, 3.71714384851537)</span></span>
<span><span class="co">#&gt;         label("11 - pdadd.err")</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.0785849119252598</span></span>
<span><span class="co">#&gt;         eta.v ~ 0.0508226905750953</span></span>
<span><span class="co">#&gt;         eta.ec50 ~ 0.18426809257979</span></span>
<span><span class="co">#&gt;         eta.e0 ~ 0.00274561514766752</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(DEPOT)</span></span>
<span><span class="co">#&gt;         cmt(GUT)</span></span>
<span><span class="co">#&gt;         cmt(CENTER)</span></span>
<span><span class="co">#&gt;         cmt(EFFECT)</span></span>
<span><span class="co">#&gt;         ktr &lt;- exp(tktr)</span></span>
<span><span class="co">#&gt;         ka &lt;- exp(tka)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(tcl + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(tv + eta.v)</span></span>
<span><span class="co">#&gt;         emax &lt;- expit(temax)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- exp(tec50 + eta.ec50)</span></span>
<span><span class="co">#&gt;         kout &lt;- exp(tkout)</span></span>
<span><span class="co">#&gt;         e0 &lt;- exp(te0 + eta.e0)</span></span>
<span><span class="co">#&gt;         EFFECT(0) &lt;- e0</span></span>
<span><span class="co">#&gt;         dcp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         pd &lt;- 1 - emax * dcp/(ec50 + dcp)</span></span>
<span><span class="co">#&gt;         kin &lt;- e0 * kout</span></span>
<span><span class="co">#&gt;         d/dt(DEPOT) &lt;- -ktr * DEPOT</span></span>
<span><span class="co">#&gt;         d/dt(GUT) &lt;- ktr * DEPOT - ka * GUT</span></span>
<span><span class="co">#&gt;         d/dt(CENTER) &lt;- ka * GUT - cl/v * CENTER</span></span>
<span><span class="co">#&gt;         d/dt(EFFECT) &lt;- kin * pd - kout * EFFECT</span></span>
<span><span class="co">#&gt;         eff &lt;- EFFECT</span></span>
<span><span class="co">#&gt;         dcp ~ add(pkadd.err) + prop(prop.err)</span></span>
<span><span class="co">#&gt;         eff ~ add(pdadd.err)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
<p>Since you have <code>babelmixr2</code> you could use
<code>babelmixr2</code> to run the model for you in NONMEM (if you have
it setup to run NONMEM), or even run the model from <code>nlmixr2</code>
itself. In this example we will choose to use <code>nlmixr2</code>
(since the <code>babelmixr2</code> example runs NONMEM and shows a
reduction in shrinkage)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">nlmixr</span>(mod3, new<span class="sc">$</span>nonmemData, <span class="st">"focei"</span>, <span class="fu">foceiControl</span>(<span class="at">print=</span><span class="dv">0</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → loading into  [34m [34msymengine [34m [39m environment...</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32m✔ [39m done</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → calculate jacobian</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → calculate sensitivities</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → calculate ∂(f)/∂(η)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → calculate ∂(R²)/∂(η)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → finding duplicate expressions in inner model...</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → optimizing duplicate expressions in inner model...</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → compiling inner model...</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32m✔ [39m done</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → finding duplicate expressions in FD model...</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → optimizing duplicate expressions in FD model...</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → compiling EBE model...</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32m✔ [39m done</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → compiling events FD model...</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32m✔ [39m done</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Theta reset (zero/bad gradient values); Switch to bobyqa</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in .foceiFitInternal(.env) : Starting values violate bounds</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Restart 1</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calculating covariance matrix</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 3.98853e-16, the</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.8669e-18, the</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.88228e-18, the</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.0677e-18, the</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 8.1123e-18, the</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.30718e-18, the</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.22652e-19, the</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 3.6184e-18, the</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 6.50329e-18, the</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.63532e-18, the</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 3.96474e-18, the</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.30655e-18, the</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.31114e-18, the</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 6.48765e-18, the</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.73529e-18, the</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.5935e-18, the</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.16009e-18, the</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.34583e-18, the</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.09633e-18, the</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.49952e-18, the</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.23263e-18, the</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.59301e-18, the</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.42483e-18, the</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.23277e-18, the</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.34578e-18, the</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.05491e-18, the</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.05471e-18, the</span></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.05632e-18, the</span></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 3.18081e-18, the</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 4.63525e-18, the</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 3.89326e-18, the</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; unhandled error message: EE:lsoda -- at t = 0 and step size _rxC(h) = 5.23252e-18, the</span></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  corrector convergence failed repeatedly or</span></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  with fabs(_rxC(h)) = hmin</span></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  @(lsoda.c:889</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|=</span></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>S matrix calculation failed; Switch to R<span class="sc">-</span>matrix covariance.</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ===] 0:00:12 </span></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; done</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → Calculating residuals/tables</span></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32m✔ [39m done</span></span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; → compress parHist in nlmixr2 object, save 461280</span></span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>fit2</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m──  [34mnlmix [39m [31mr² [39m  [33mFOCE [39m [31mi [39m [22m (outer: bobyqa) ──</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FOCEi 3255.418 4173.112 4235.813      -2071.556        72388294               1</span></span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m── Time (sec  [33mfit2 [39m [34m$time [39m): ── [22m</span></span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            setup optimize covariance table compress    other</span></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elapsed 0.008946 12.01924   12.01924 0.075    0.015 1101.232</span></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m── Population Parameters ( [33mfit2 [39m [34m$parFixed [39m or  [33mfit2 [39m [34m$parFixedDf [39m): ── [22m</span></span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 [1m [1mParameter [0m [0m      [1mEst. [0m        [1m [1mSE [0m [0m    [1m%RSE [0m        [1mBack-transformed(95%CI) [0m</span></span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtktr [0m [0m            1 -  [1m [1mtktr [0m [0m     11.7  0.00282 0.0241   1.2e+05 (1.2e+05, 1.21e+05)</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtka [0m [0m              2 -  [1m [1mtka [0m [0m    -11.4  0.00275 0.0241 1.12e-05 (1.11e-05, 1.12e-05)</span></span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtcl [0m [0m              3 -  [1m [1mtcl [0m [0m    -1.37 0.000527 0.0384          0.253 (0.253, 0.254)</span></span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtv [0m [0m                4 -  [1m [1mtv [0m [0m     10.6  0.00257 0.0243 3.86e+04 (3.84e+04, 3.88e+04)</span></span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mprop.err [0m [0m    5 -  [1m [1mprop.err [0m [0m    0.206                                         0.206</span></span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mpkadd.err [0m [0m  6 -  [1m [1mpkadd.err [0m [0m     7.46                                          7.46</span></span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtemax [0m [0m          7 -  [1m [1mtemax [0m [0m 2.02e+04     4.48 0.0222                      1 (1, 1)</span></span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtec50 [0m [0m          8 -  [1m [1mtec50 [0m [0m    -2.19 0.000707 0.0324          0.112 (0.112, 0.112)</span></span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtkout [0m [0m          9 -  [1m [1mtkout [0m [0m       20  0.00212 0.0106 5.07e+08 (5.05e+08, 5.09e+08)</span></span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mte0 [0m [0m             10 -  [1m [1mte0 [0m [0m      3.5  0.00142 0.0407               33 (32.9, 33.1)</span></span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mpdadd.err [0m [0m 11 -  [1m [1mpdadd.err [0m [0m     44.8                                          44.8</span></span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [1mBSV(CV%) [0m  [1mShrink(SD)% [0m</span></span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtktr [0m [0m                          </span></span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtka [0m [0m                           </span></span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtcl [0m [0m           69.4       [1;31m99.9% [0m </span></span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtv [0m [0m            2.25       [1;31m97.9% [0m </span></span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mprop.err [0m [0m                      </span></span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mpkadd.err [0m [0m                     </span></span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtemax [0m [0m                         </span></span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtec50 [0m [0m         123.       [1;31m99.9% [0m </span></span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mtkout [0m [0m                         </span></span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mte0 [0m [0m          0.524       [1;31m99.7% [0m </span></span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m [1mpdadd.err [0m [0m                     </span></span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Covariance Type ( [33mfit2 [39m [1m [34m$covMethod [39m [22m):  [1m|r| [22m</span></span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Full BSV covariance ( [33mfit2 [39m [1m [34m$omega [39m [22m) or correlation ( [33mfit2 [39m [1m [34m$omegaR [39m [22m; diagonals=SDs) </span></span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in  [33mfit2 [39m [1m [34m$shrink [39m [22m </span></span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Information about run found ( [33mfit2 [39m [1m [34m$runInfo [39m [22m):</span></span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • zero gradient replaced with small number (0.000000) </span></span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • tolerances (atol/rtol) were increased (after 4 bad solves) for some difficult ODE solving during the optimization. can control with foceiControl(stickyRecalcN=) consider increasing sigdig/atol/rtol changing initial estimates or changing the structural model </span></span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • gradient problems with covariance; see $scaleInfo </span></span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • using R matrix to calculate covariance, can check sandwich or S matrix with $covRS and $covS </span></span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • R matrix non-positive definite but corrected by R = sqrtm(R%*%R) </span></span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • S matrix had problems solving for some subject and parameters </span></span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • bad solve during optimization </span></span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) </span></span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) </span></span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • Hessian reset during optimization; (can control by foceiControl(resetHessianAndEta=.)) </span></span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    • thetas were reset during optimization because of a zero gradient </span></span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Censoring ( [33mfit2 [39m [1m [34m$censInformation [39m [22m): No censoring</span></span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Minimization message ( [33mfit2 [39m [1m [34m$message [39m [22m):  </span></span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Normal exit from bobyqa </span></span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1m── Fit Data (object  [33mfit2 [39m is a modified  [34mtibble [39m): ── [22m</span></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m# A tibble: 483 × 33 [39m</span></span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ID     TIME CMT      DV       PRED      RES     WRES   IPRED     IRES    IWRES</span></span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [3m [38;5;246m&lt;fct&gt; [39m [23m  [3m [38;5;246m&lt;dbl&gt; [39m [23m  [3m [38;5;246m&lt;fct&gt; [39m [23m  [3m [38;5;246m&lt;dbl&gt; [39m [23m       [3m [38;5;246m&lt;dbl&gt; [39m [23m     [3m [38;5;246m&lt;dbl&gt; [39m [23m     [3m [38;5;246m&lt;dbl&gt; [39m [23m    [3m [38;5;246m&lt;dbl&gt; [39m [23m     [3m [38;5;246m&lt;dbl&gt; [39m [23m     [3m [38;5;246m&lt;dbl&gt; [39m [23m</span></span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;250m1 [39m 1       0.5 dcp     0      1.45 [38;5;246me [39m [31m-8 [39m - [31m1 [39m [31m. [39m [31m45 [39m [38;5;246me [39m [31m-8 [39m - [31m1 [39m [31m. [39m [31m94 [39m [38;5;246me [39m [31m-9 [39m 1.45 [38;5;246me [39m [31m-8 [39m - [31m1 [39m [31m. [39m [31m45 [39m [38;5;246me [39m [31m-8 [39m - [31m1 [39m [31m. [39m [31m94 [39m [38;5;246me [39m [31m-9 [39m</span></span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;250m2 [39m 1       1   dcp     1.9    2.90 [38;5;246me [39m [31m-8 [39m  1.90 [38;5;246me [39m+0  2.55 [38;5;246me [39m [31m-1 [39m 2.90 [38;5;246me [39m [31m-8 [39m  1.90 [38;5;246me [39m+0  2.55 [38;5;246me [39m [31m-1 [39m</span></span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;250m3 [39m 1       2   dcp     3.3    5.80 [38;5;246me [39m [31m-8 [39m  3.30 [38;5;246me [39m+0  4.43 [38;5;246me [39m [31m-1 [39m 5.79 [38;5;246me [39m [31m-8 [39m  3.30 [38;5;246me [39m+0  4.43 [38;5;246me [39m [31m-1 [39m</span></span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m# ℹ 480 more rows [39m</span></span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m# ℹ 23 more variables: CPRED &lt;dbl&gt;, CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.cl &lt;dbl&gt;, [39m</span></span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m#   eta.v &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;, eta.e0 &lt;dbl&gt;, DEPOT &lt;dbl&gt;, GUT &lt;dbl&gt;, [39m</span></span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m#   CENTER &lt;dbl&gt;, EFFECT &lt;dbl&gt;, ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, [39m</span></span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m#   emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;, e0 &lt;dbl&gt;, pd &lt;dbl&gt;, kin &lt;dbl&gt;, [39m</span></span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [38;5;246m#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt; [39m</span></span></code></pre></div>
<p>With these modifications the shrinkage is also reduced (just like in
the NONMEM case)</p>
</div>
<div class="section level2">
<h2 id="step-5-get-the-covariance-of-the-model">Step 5: Get the covariance of the model<a class="anchor" aria-label="anchor" href="#step-5-get-the-covariance-of-the-model"></a>
</h2>
<p>Another thing that can be helpful when the fit has been imported into
a <code>nlmixr2</code> fit is to get the variance/covariance matrix.
This can be especially helpful to diagnose things to help simplify your
model</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getVarCov.html" class="external-link">getVarCov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → calculate jacobian</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate sensitivities</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate ∂(f)/∂(η)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling inner model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compiling events FD model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; calculating covariance matrix</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|=</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): S matrix non-positive definite</span></span>
<span><span class="co">#&gt; ===] 0:00:09</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): R matrix non-positive definite but corrected by</span></span>
<span><span class="co">#&gt; R = sqrtm(R%*%R)</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): using R matrix to calculate covariance, can</span></span>
<span><span class="co">#&gt; check sandwich or S matrix with $covRS and $covS</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): gradient problems with covariance; see</span></span>
<span><span class="co">#&gt; $scaleInfo</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span><span class="co">#&gt; Updated original fit object <span style="color: #BBBB00;">fit</span></span></span>
<span><span class="co">#&gt;               tktr           tka           tcl            tv         temax</span></span>
<span><span class="co">#&gt; tktr   0.027507185 -0.0229743954 -0.0118847050  0.0024605889 -0.0015303604</span></span>
<span><span class="co">#&gt; tka   -0.022974395  0.0845683475 -0.1209728069 -0.0042645578  0.0003075893</span></span>
<span><span class="co">#&gt; tcl   -0.011884705 -0.1209728069  0.6242221602 -0.0041134945  0.0095313445</span></span>
<span><span class="co">#&gt; tv     0.002460589 -0.0042645578 -0.0041134945  0.0108631250  0.0008375679</span></span>
<span><span class="co">#&gt; temax -0.001530360  0.0003075893  0.0095313445  0.0008375679 44.4431461692</span></span>
<span><span class="co">#&gt; tec50 -0.034910826  0.0225962330  0.1150552735 -0.0012409312  0.0491652327</span></span>
<span><span class="co">#&gt; tkout -0.002987253  0.0081951496  0.0041489065  0.0073475010 -0.1357478339</span></span>
<span><span class="co">#&gt; te0   -0.004760930  0.0039403914  0.0007457058 -0.0036847801 -0.0262804555</span></span>
<span><span class="co">#&gt;              tec50        tkout           te0</span></span>
<span><span class="co">#&gt; tktr  -0.034910826 -0.002987253 -0.0047609302</span></span>
<span><span class="co">#&gt; tka    0.022596233  0.008195150  0.0039403914</span></span>
<span><span class="co">#&gt; tcl    0.115055273  0.004148906  0.0007457058</span></span>
<span><span class="co">#&gt; tv    -0.001240931  0.007347501 -0.0036847801</span></span>
<span><span class="co">#&gt; temax  0.049165233 -0.135747834 -0.0262804555</span></span>
<span><span class="co">#&gt; tec50  0.640371952  0.062631972  0.0150208540</span></span>
<span><span class="co">#&gt; tkout  0.062631972  0.074705994 -0.0291146671</span></span>
<span><span class="co">#&gt; te0    0.015020854 -0.029114667  0.0751101557</span></span>
<span><span class="va">fit</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">nonmem2rx</span><span style="font-weight: bold;"> reading NONMEM ver 7.4.3 ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               OBJF     AIC      BIC Log-likelihood</span></span>
<span><span class="co">#&gt; nonmem2rx 439.2156 1364.91 1444.331      -663.4551</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #BBBB00; font-weight: bold;">fit</span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup table compress NONMEM as.nlmixr2 covariance</span></span>
<span><span class="co">#&gt; elapsed 0.024159 0.043    0.014 320.27      3.735     18.411</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #BBBB00; font-weight: bold;">fit</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #BBBB00; font-weight: bold;">fit</span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                <span style="font-weight: bold;">Parameter</span>      <span style="font-weight: bold;">Est.</span>    <span style="font-weight: bold;">SE</span>     <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>            1 - <span style="font-weight: bold;">tktr</span>  6.24e-07 0.166 2.66e+07         1 (0.722, 1.38)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>              2 - <span style="font-weight: bold;">tka</span> -3.01e-06 0.291 9.67e+06         1 (0.566, 1.77)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>              3 - <span style="font-weight: bold;">tcl</span>        -2  0.79     39.4   0.135 (0.0287, 0.634)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>                4 - <span style="font-weight: bold;">tv</span>      2.05 0.104     5.08       7.78 (6.34, 9.55)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>    5 - <span style="font-weight: bold;">prop.err</span>    0.0986                                 0.0986</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>  6 - <span style="font-weight: bold;">pkadd.err</span>     0.512                                  0.512</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>          7 - <span style="font-weight: bold;">temax</span>      6.42  6.67      104       0.998 (0.0013, 1)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>          8 - <span style="font-weight: bold;">tec50</span>     0.141   0.8      568       1.15 (0.24, 5.52)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>          9 - <span style="font-weight: bold;">tkout</span>     -2.95 0.273     9.25 0.0522 (0.0305, 0.0891)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>             10 - <span style="font-weight: bold;">te0</span>      4.57 0.274        6        96.6 (56.4, 165)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span> 11 - <span style="font-weight: bold;">pdadd.err</span>      3.72                                   3.72</span></span>
<span><span class="co">#&gt;           <span style="font-weight: bold;">BSV(CV% or SD)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>                86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>                 86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>                 28.6      1.34% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>                  22.8      6.44% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>                            </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>                           </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>               3.00      <span style="color: #BB0000; font-weight: bold;">100.%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>               45.0      6.06% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>               9.16      <span style="color: #BB0000; font-weight: bold;">32.4%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>                 5.24      18.1% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span>                           </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">|r|</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt;   Minimization message (<span style="color: #BBBB00;">fit</span><span style="color: #0000BB; font-weight: bold;">$message</span>):  </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; 0MINIMIZATION TERMINATED</span></span>
<span><span class="co">#&gt;  DUE TO ROUNDING ERRORS (ERROR=134)</span></span>
<span><span class="co">#&gt;  NO. OF FUNCTION EVALUATIONS USED:     1088</span></span>
<span><span class="co">#&gt;  NO. OF SIG. DIGITS UNREPORTABLE</span></span>
<span><span class="co">#&gt; 0PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=5.09e-06</span></span>
<span><span class="co">#&gt;     PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=5.29e-06</span></span>
<span><span class="co">#&gt;     IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.2e-06, 0.000454); atol=3.03e-05</span></span>
<span><span class="co">#&gt;     PRED absolute difference compared to Nonmem PRED: 95% percentile: (4.72e-07,0.00361); atol=5.29e-06</span></span>
<span><span class="co">#&gt;     there are solving errors during optimization (see '$prderr')</span></span>
<span><span class="co">#&gt;     nonmem2rx model file: 'pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl' </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object </span><span style="color: #BBBB00; font-weight: bold;">fit</span><span style="font-weight: bold;"> is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 483 × 35</span></span></span>
<span><span class="co">#&gt;   ID     TIME CMT      DV  PRED   RES IPRED   IRES  IWRES eta.ktr eta.ka eta.cl</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       0.5 dcp     0    1.16 -<span style="color: #BB0000;">1.16</span> 0.444 -<span style="color: #BB0000;">0.444</span> -<span style="color: #BB0000;">0.864</span>  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       1   dcp     1.9  3.37 -<span style="color: #BB0000;">1.47</span> 1.45   0.446  0.840  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       2   dcp     3.3  7.51 -<span style="color: #BB0000;">4.21</span> 3.96  -<span style="color: #BB0000;">0.660</span> -<span style="color: #BB0000;">1.03</span>   -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 480 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more variables: eta.v &lt;dbl&gt;, eta.emax &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.kout &lt;dbl&gt;, eta.e0 &lt;dbl&gt;, dcp &lt;dbl&gt;, eff &lt;dbl&gt;, DEPOT &lt;dbl&gt;, GUT &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CENTER &lt;dbl&gt;, EFFECT &lt;dbl&gt;, ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;, e0 &lt;dbl&gt;, pd &lt;dbl&gt;, kin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Note this covariance step is not 100% successful since it is not
<code>r, s</code>. However, it can give some insights on which
parameters are estimated well. In this case you can see that the
<code>emax</code> parameter is more poorly estimated than other
parameters, which means fixing the parameter or reducing other
parameters may help your estimate progress in <code>NONMEM</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
