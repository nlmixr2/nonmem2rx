<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reading rounding from NONMEM • nonmem2rx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reading rounding from NONMEM">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nonmem2rx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-converting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-arrow-right"></span> Converting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-converting">
<li><a class="dropdown-item" href="../articles/import-nonmem.html">Converting NONMEM to rxode2 model</a></li>
    <li><a class="dropdown-item" href="../articles/convert-nlmixr2.html">Converting NONMEM to nlmixr2 object</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/rxode2-validate.html"><span class="fa fa-check"></span> Qualify</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-dice"></span> Simulation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulation">
<li><a class="dropdown-item" href="../articles/simulate-new-dosing.html">New Dosing Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-uncertainty.html">Simulating with Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-extra-items.html">Simulating with Derived Variables</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-new-dosing-with-covs.html">Simulating with Covariates/Input PK parameters</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reporting" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reporting</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reporting">
<li><a class="dropdown-item" href="../articles/create-office.html">Creating word and powerpoint documents</a></li>
    <li><a class="dropdown-item" href="../articles/create-vpc.html">Easily create VPC plots</a></li>
    <li><a class="dropdown-item" href="../articles/create-augPred.html">Create enriched Individual plots</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../articles/read-rounding.html"><span class="fa fa-bug"></span> Debug</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-rss"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nonmem2rx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Reading rounding from NONMEM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nonmem2rx/blob/v0.1.7/vignettes/articles/read-rounding.Rmd" class="external-link"><code>vignettes/articles/read-rounding.Rmd</code></a></small>
      <div class="d-none name"><code>read-rounding.Rmd</code></div>
    </div>

    
    
<p>One of the things that can be helpful is reading NONMEM with rounding
errors.</p>
<p>For this example we will take some of the test examples from
<code>babelmixr2</code> to translate to show examples of rounding errors
that can be read in to help diagnose what could be happening with the
model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nonmem2rx/" class="external-link">nonmem2rx</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/babelmixr2/" class="external-link">babelmixr2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="step-1-have-a-nonmem-model-with-rounding-errors-and--phi-or-other-information-about-the-etas">Step 1: Have a NONMEM model with rounding errors (and
<code>.phi</code> or other information about the <code>etas</code>)<a class="anchor" aria-label="anchor" href="#step-1-have-a-nonmem-model-with-rounding-errors-and--phi-or-other-information-about-the-etas"></a>
</h2>
<p>The first step is to load a model with rounding errors using
<code><a href="../reference/nonmem2rx.html">nonmem2rx()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unzip example with rounding error</span></span>
<span><span class="co"># included, but can be accessed with nlmixr2</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># unzip(system.file("tests/testthat/pk.turnover.emax3-nonmem.zip", package="babelmixr2"))</span></span>
<span><span class="co"># Load the model with `nonmem2rx`:</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonmem2rx.html">nonmem2rx</a></span><span class="op">(</span><span class="st">"pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> getting information from  'pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in xml file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in ext file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in phi file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in lst file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> abbreviated list parsing</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> reading in grd file</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> splitting control stream by records</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $MODEL</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $gTHETA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $OMEGA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SIGMA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PROBLEM</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DATA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $SUBROUTINES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $PK</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $DES</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ERROR</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $ESTIMATION</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Ignore record $COVARIANCE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing record $TABLE</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta1` to `6.24053043162953e-07`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta2` to `-3.00642760553675e-06`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta3` to `-2.00405074386117`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta4` to `2.05188410700476`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta5` to `0.0985804613565218`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta6` to `0.511625249037084`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta7` to `6.4184983102259`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta8` to `0.140763261319656`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta9` to `-2.9534704318737`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta10` to `4.57045413136592`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `theta11` to `3.71714384851537`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta1` to `0.558129815059436`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta2` to `0.558402321309217`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta3` to `0.0785849119252598`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta4` to `0.0508226905750953`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta5` to `5e-05`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta6` to `0.18426809257979`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta7` to `0.0083631531443303`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eta8` to `0.00274561514766752`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem input data (for model validation): /home/runner/work/nonmem2rx/nonmem2rx/vignettes/articles/pk.turnover.emax3-nonmem/pk.turnover.emax3.csv</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> ignoring lines that begin with a letter (IGNORE=@)'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> applying names specified by $INPUT</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming 'dvid' to 'nmdvid'</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> read in nonmem IPRED data (for model validation): /home/runner/work/nonmem2rx/nonmem2rx/vignettes/articles/pk.turnover.emax3-nonmem/pk.turnover.emax3.pred</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> changing most variables to lower case</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace theta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> replace eta names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> renaming compartments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="va">mod</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mi>U</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>k</mi><mi>a</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>3</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>c</mi><mi>l</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>4</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>v</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>5</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>6</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>7</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>m</mi><mi>u</mi><mi>_</mi><mn>8</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>t</mi><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>t</mi><mi>r</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>1</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>a</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>2</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>3</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>4</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>5</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>c</mi><mn>50</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>6</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>7</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>m</mi><mi>u</mi><mi>_</mi><mn>8</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mn>0</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>.</mi><mi>r</mi><mi>x</mi><mi>d</mi><mi>d</mi><mi>t</mi><mi>a</mi><mn>4</mn><mi>.</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>.</mi><mi>r</mi><mi>x</mi><mi>d</mi><mi>d</mi><mi>t</mi><mi>a</mi><mn>4</mn><mi>.</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>≥</mo><mn>0</mn><mo>∧</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>≤</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>=</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>≥</mo><mo>−</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><mo>∧</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>&lt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow><mo>=</mo><mo>−</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow></mrow><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mn>001</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mo>−</mo><mfrac><mrow><mi>c</mi><mi>l</mi></mrow><mi>v</mi></mfrac><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>i</mi><mi>n</mi></mrow><mo>×</mo><mrow><mi>p</mi><mi>d</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>×</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>d</mi><mi>c</mi><mi>p</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>≥</mo><mn>0</mn><mo>∧</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>≤</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>=</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>≥</mo><mo>−</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><mo>∧</mo><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>&lt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow><mo>=</mo><mo>−</mo><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>p</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>d</mi><mi>c</mi><mi>p</mi></mrow></mrow><mrow><mi>r</mi><mi>x</mi><mi>d</mi><mi>z</mi><mi>e</mi><mn>001</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mi>f</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>e</mi><mi>_</mi><mi>c</mi><mi>p</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mi>f</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mi>f</mi><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>w</mi><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>k</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mi>f</mi><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>×</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>w</mi><mn>1</mn></mrow><mo>≡</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>w</mi><mn>1</mn></mrow><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mi>f</mi><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>r</mi><mi>x</mi><mi>_</mi><mi>p</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>w</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>d</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>w</mi><mn>2</mn></mrow><mo>≡</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>w</mi><mn>2</mn></mrow><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>i</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>w</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>w</mi><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>n</mi><mi>m</mi><mi>d</mi><mi>v</mi><mi>i</mi><mi>d</mi></mrow><mo>≡</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mrow><mi>i</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow><mo>=</mo><mrow><mi>r</mi><mi>x</mi><mi>_</mi><mi>i</mi><mi>p</mi><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>w</mi><mo>=</mo><mrow><mi>w</mi><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>y</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>i</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow><mo>+</mo><mi>w</mi><mo>×</mo><mrow><mi>e</mi><mi>p</mi><mi>s</mi><mn>1</mn></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
cmt({DEPOT}) \\
cmt({GUT}) \\
cmt({CENTER}) \\
cmt({EFFECT}) \\
{mu\_1} &amp; = {tktr} \\
{mu\_2} &amp; = {tka} \\
{mu\_3} &amp; = {tcl} \\
{mu\_4} &amp; = {tv} \\
{mu\_5} &amp; = {temax} \\
{mu\_6} &amp; = {tec50} \\
{mu\_7} &amp; = {tkout} \\
{mu\_8} &amp; = {te0} \\
{ktr} &amp; = \exp\left({mu\_1}+{eta.ktr}\right) \\
{ka} &amp; = \exp\left({mu\_2}+{eta.ka}\right) \\
{cl} &amp; = \exp\left({mu\_3}+{eta.cl}\right) \\
{v} &amp; = \exp\left({mu\_4}+{eta.v}\right) \\
{emax} &amp; = \left(\left({1}\right)-\left({0}\right)\right) {\times} \left(\frac{{1}}{\left({1}+\exp\left(-\left({mu\_5}+{eta.emax}\right)\right)\right)}\right)+\left({0}\right) \\
{ec50} &amp; = \exp\left({mu\_6}+{eta.ec50}\right) \\
{kout} &amp; = \exp\left({mu\_7}+{eta.kout}\right) \\
{e0} &amp; = \exp\left({mu\_8}+{eta.e0}\right) \\
{rxini.rxddta4.} &amp; = {e0} \\
EFFECT({0}) &amp; = {rxini.rxddta4.} \\
{dcp} &amp; = \frac{{CENTER}}{{v}} \\
{rxdz001} &amp; = \left({ec50}+{dcp}\right) \\
\mathrm{if} &amp; \left({rxdz001}{\geq}{0}{\land}{rxdz001}{\leq}{1 \times 10^{-6}}\right) \{ \\
 &amp; {rxdz001}  = {1 \times 10^{-6}} \\
\}  \\
\mathrm{if} &amp; \left({rxdz001}{\geq}-{1 \times 10^{-6}}{\land}{rxdz001}&lt;{0}\right) \{ \\
 &amp; {rxdz001}  = -{1 \times 10^{-6}} \\
\}  \\
{pd} &amp; = {1}-\frac{{emax} {\times} {dcp}}{{rxdz001}} \\
{kin} &amp; = {e0} {\times} {kout} \\
\frac{d \: DEPOT}{dt} &amp; = -{ktr} {\times} {DEPOT} \\
\frac{d \: GUT}{dt} &amp; = {ktr} {\times} {DEPOT}-{ka} {\times} {GUT} \\
\frac{d \: CENTER}{dt} &amp; = {ka} {\times} {GUT}-\frac{{cl}}{{v}} {\times} {CENTER} \\
\frac{d \: EFFECT}{dt} &amp; = {kin} {\times} {pd}-{kout} {\times} {EFFECT} \\
{cp} &amp; = \frac{{CENTER}}{{v}} \\
{f} &amp; = {DEPOT} \\
{rxe\_dcp} &amp; = \frac{{CENTER}}{{v}} \\
{rxdze001} &amp; = \left({ec50}+{rxe\_dcp}\right) \\
\mathrm{if} &amp; \left({rxdze001}{\geq}{0}{\land}{rxdze001}{\leq}{1 \times 10^{-6}}\right) \{ \\
 &amp; {rxdze001}  = {1 \times 10^{-6}} \\
\}  \\
\mathrm{if} &amp; \left({rxdze001}{\geq}-{1 \times 10^{-6}}{\land}{rxdze001}&lt;{0}\right) \{ \\
 &amp; {rxdze001}  = -{1 \times 10^{-6}} \\
\}  \\
{rxe\_pd} &amp; = {1}-\frac{{emax} {\times} {rxe\_dcp}}{{rxdze001}} \\
{rxe\_kin} &amp; = {e0} {\times} {kout} \\
{rxe\_cp} &amp; = \frac{{CENTER}}{{v}} \\
{rx\_pf1} &amp; = {rxe\_cp} \\
{rx\_pf2} &amp; = {EFFECT} \\
{rx\_ip1} &amp; = {rx\_pf1} \\
{rx\_p1} &amp; = {rx\_ip1} \\
{w1} &amp; = sqrt({\left({pkadd.err}\right)}^{{2}}+{\left({rx\_pf1}\right)}^{{2}} {\times} {\left({prop.err}\right)}^{{2}}) \\
\mathrm{if} &amp; \left({w1}{\equiv}{0}\right) {w1}  = {1} \\
{rx\_ip2} &amp; = {rx\_pf2} \\
{rx\_p2} &amp; = {rx\_ip2} \\
{w2} &amp; = sqrt({\left({pdadd.err}\right)}^{{2}}) \\
\mathrm{if} &amp; \left({w2}{\equiv}{0}\right) {w2}  = {1} \\
{ipred} &amp; = {rx\_ip1} \\
{w} &amp; = {w1} \\
\mathrm{if} &amp; \left({nmdvid}{\equiv}{2}\right) \{ \\
 &amp; {ipred}  = {rx\_ip2} \\
 &amp; {w}  = {w2} \\
\}  \\
{y} &amp; = {ipred}+{w} {\times} {eps1}
\end{align*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="step-2-convert-rxode2-model-to-model-with-endpointsresiduals-specified-like-nlmixr2">Step 2: Convert <code>rxode2</code> model to model with
endpoints/residuals specified like <code>nlmixr2</code><a class="anchor" aria-label="anchor" href="#step-2-convert-rxode2-model-to-model-with-endpointsresiduals-specified-like-nlmixr2"></a>
</h2>
<p>This example has rounding errors and isn’t a fully qualified
<code>nlmixr2</code> model (even though it was generated from
<code>nlmixr2</code>).</p>
<p>We can use the model and create an equivalent model with
<code><a href="../reference/as.nonmem2rx.html">as.nonmem2rx()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tktr</span> <span class="op">&lt;-</span> <span class="fl">6.24053043162953e-07</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"1 - tktr"</span><span class="op">)</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3.00642760553675e-06</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"2 - tka"</span><span class="op">)</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.00405074386117</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"3 - tcl"</span><span class="op">)</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">2.05188410700476</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"4 - tv"</span><span class="op">)</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.0985804613565218</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"5 - prop.err"</span><span class="op">)</span></span>
<span>    <span class="va">pkadd.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.511625249037084</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"6 - pkadd.err"</span><span class="op">)</span></span>
<span>    <span class="va">temax</span> <span class="op">&lt;-</span> <span class="fl">6.4184983102259</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"7 - temax"</span><span class="op">)</span></span>
<span>    <span class="va">tec50</span> <span class="op">&lt;-</span> <span class="fl">0.140763261319656</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"8 - tec50"</span><span class="op">)</span></span>
<span>    <span class="va">tkout</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.9534704318737</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"9 - tkout"</span><span class="op">)</span></span>
<span>    <span class="va">te0</span> <span class="op">&lt;-</span> <span class="fl">4.57045413136592</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"10 - te0"</span><span class="op">)</span></span>
<span>    <span class="va">pdadd.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.71714384851537</span><span class="op">)</span></span>
<span>    <span class="fu">label</span><span class="op">(</span><span class="st">"11 - pdadd.err"</span><span class="op">)</span></span>
<span>    <span class="va">eta.ktr</span> <span class="op">~</span> <span class="fl">0.558129815059436</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.558402321309217</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.0785849119252598</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.0508226905750953</span></span>
<span>    <span class="va">eta.emax</span> <span class="op">~</span> <span class="fl">5e-05</span></span>
<span>    <span class="va">eta.ec50</span> <span class="op">~</span> <span class="fl">0.18426809257979</span></span>
<span>    <span class="va">eta.kout</span> <span class="op">~</span> <span class="fl">0.0083631531443303</span></span>
<span>    <span class="va">eta.e0</span> <span class="op">~</span> <span class="fl">0.00274561514766752</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">DEPOT</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">GUT</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">CENTER</span><span class="op">)</span></span>
<span>    <span class="fu">cmt</span><span class="op">(</span><span class="va">EFFECT</span><span class="op">)</span></span>
<span>    <span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span> <span class="op">+</span> <span class="va">eta.ktr</span><span class="op">)</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span>   <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span>   <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span>     <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">emax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/logit.html" class="external-link">expit</a></span><span class="op">(</span><span class="va">temax</span> <span class="op">+</span> <span class="va">eta.emax</span><span class="op">)</span> </span>
<span>    <span class="va">ec50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tec50</span> <span class="op">+</span> <span class="va">eta.ec50</span><span class="op">)</span></span>
<span>    <span class="va">kout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span> <span class="op">+</span> <span class="va">eta.kout</span><span class="op">)</span></span>
<span>    <span class="va">e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">te0</span> <span class="op">+</span> <span class="va">eta.e0</span><span class="op">)</span></span>
<span>    <span class="fu">EFFECT</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">e0</span></span>
<span>    <span class="va">dcp</span> <span class="op">&lt;-</span> <span class="va">CENTER</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">emax</span> <span class="op">*</span> <span class="va">dcp</span><span class="op">/</span><span class="op">(</span><span class="va">ec50</span> <span class="op">+</span> <span class="va">dcp</span><span class="op">)</span></span>
<span>    <span class="va">kin</span> <span class="op">&lt;-</span> <span class="va">e0</span> <span class="op">*</span> <span class="va">kout</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">DEPOT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">ktr</span> <span class="op">*</span> <span class="va">DEPOT</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">GUT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ktr</span> <span class="op">*</span> <span class="va">DEPOT</span> <span class="op">-</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">GUT</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">CENTER</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">GUT</span> <span class="op">-</span> <span class="va">cl</span><span class="op">/</span><span class="va">v</span> <span class="op">*</span> <span class="va">CENTER</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">EFFECT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">kin</span> <span class="op">*</span> <span class="va">pd</span> <span class="op">-</span> <span class="va">kout</span> <span class="op">*</span> <span class="va">EFFECT</span></span>
<span>    <span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">EFFECT</span></span>
<span>    <span class="va">dcp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span><span class="op">+</span><span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span>    <span class="va">eff</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the model above, the following modifications were made:</p>
<ul>
<li><p>The code for protecting for rounding errors was removed</p></li>
<li><p>Endpoints/residual specifications were added</p></li>
<li><p>Duplicate code in NONMEM’s <code>$ERROR</code> block was removed
from imported model</p></li>
<li><p>All the <code>rx</code> and <code>nlmixr</code> prefixed items
were removed from the model. It is possible that not removing these
variables can cause<code>nlmixr2</code> conversion to fail. It is best
practice to remove them completely.</p></li>
</ul>
<p>Also, it is good practice to make sure the model parses correctly
before trying to validate/convert the model. If you find that your model
doesn’t parse correctly it definitely won’t validate (and the error may
not be as easy to track-down).</p>
<p>The first step is to validate if the translation is correct. This is
done below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.nonmem2rx.html">as.nonmem2rx</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> copy 'dfSub' to nonmem2rx model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> copy 'dfObs' to nonmem2rx model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> merging 'dvid' with nlmixr2 'cmt' definition</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving ipred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> solving pred problem</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> done</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt;  <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">rxode2-based free-form 4-cmt ODE model</span> <span style="color: #00BBBB;">──────────────────────────────────────</span> </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Initalization:</span> ──  </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Fixed Effects</span> (<span style="color: #0000BB; font-weight: bold;">$theta</span>): </span></span>
<span><span class="co">#&gt;          tktr           tka           tcl            tv      prop.err </span></span>
<span><span class="co">#&gt;  6.240530e-07 -3.006428e-06 -2.004051e+00  2.051884e+00  9.858046e-02 </span></span>
<span><span class="co">#&gt;     pkadd.err         temax         tec50         tkout           te0 </span></span>
<span><span class="co">#&gt;  5.116252e-01  6.418498e+00  1.407633e-01 -2.953470e+00  4.570454e+00 </span></span>
<span><span class="co">#&gt;     pdadd.err </span></span>
<span><span class="co">#&gt;  3.717144e+00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Omega</span> (<span style="color: #0000BB; font-weight: bold;">$omega</span>): </span></span>
<span><span class="co">#&gt;            eta.ktr    eta.ka     eta.cl      eta.v eta.emax  eta.ec50</span></span>
<span><span class="co">#&gt; eta.ktr  0.5581298 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.ka   0.0000000 0.5584023 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.cl   0.0000000 0.0000000 0.07858491 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.v    0.0000000 0.0000000 0.00000000 0.05082269    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.emax 0.0000000 0.0000000 0.00000000 0.00000000    5e-05 0.0000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.1842681</span></span>
<span><span class="co">#&gt; eta.kout 0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt; eta.e0   0.0000000 0.0000000 0.00000000 0.00000000    0e+00 0.0000000</span></span>
<span><span class="co">#&gt;             eta.kout      eta.e0</span></span>
<span><span class="co">#&gt; eta.ktr  0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ka   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.cl   0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.v    0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.emax 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.ec50 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; eta.kout 0.008363153 0.000000000</span></span>
<span><span class="co">#&gt; eta.e0   0.000000000 0.002745615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; States</span> (<span style="color: #0000BB; font-weight: bold;">$state</span> or <span style="color: #0000BB; font-weight: bold;">$stateDf</span>): </span></span>
<span><span class="co">#&gt;   Compartment Number Compartment Name</span></span>
<span><span class="co">#&gt; 1                  1            DEPOT</span></span>
<span><span class="co">#&gt; 2                  2              GUT</span></span>
<span><span class="co">#&gt; 3                  3           CENTER</span></span>
<span><span class="co">#&gt; 4                  4           EFFECT</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Multiple Endpoint Model (</span><span style="color: #0000BB; font-weight: bold;">$multipleEndpoint</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   variable                cmt                dvid*</span></span>
<span><span class="co">#&gt; 1  dcp ~ … cmt='dcp' or cmt=5 dvid='dcp' or dvid=1</span></span>
<span><span class="co">#&gt; 2  eff ~ … cmt='eff' or cmt=6 dvid='eff' or dvid=2</span></span>
<span><span class="co">#&gt;   * If dvids are outside this range, all dvids are re-numered sequentially, ie 1,7, 10 becomes 1,2,3 etc</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">μ-referencing (</span><span style="color: #0000BB; font-weight: bold;">$muRefTable</span><span style="font-weight: bold;">):</span> ──  </span></span>
<span><span class="co">#&gt;   theta      eta level</span></span>
<span><span class="co">#&gt; 1  tktr  eta.ktr    id</span></span>
<span><span class="co">#&gt; 2   tka   eta.ka    id</span></span>
<span><span class="co">#&gt; 3   tcl   eta.cl    id</span></span>
<span><span class="co">#&gt; 4    tv    eta.v    id</span></span>
<span><span class="co">#&gt; 5 temax eta.emax    id</span></span>
<span><span class="co">#&gt; 6 tec50 eta.ec50    id</span></span>
<span><span class="co">#&gt; 7 tkout eta.kout    id</span></span>
<span><span class="co">#&gt; 8   te0   eta.e0    id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">Model (Normalized Syntax):</span> ── </span></span>
<span><span class="co">#&gt; function() {</span></span>
<span><span class="co">#&gt;     description &lt;- c("translated from babelmixr2", "; comments show mu referenced model in ui$getSplitMuModel")</span></span>
<span><span class="co">#&gt;     dfObs &lt;- 483</span></span>
<span><span class="co">#&gt;     dfSub &lt;- 32</span></span>
<span><span class="co">#&gt;     validation &lt;- c("IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=6.13e-06", </span></span>
<span><span class="co">#&gt;         "IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (3.12e-06, 0.000497); atol=6.17e-05", </span></span>
<span><span class="co">#&gt;         "PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=6.18e-06", </span></span>
<span><span class="co">#&gt;         "PRED absolute difference compared to Nonmem PRED: 95% percentile: (3.79e-07,0.00313) atol=6.18e-06")</span></span>
<span><span class="co">#&gt;     ini({</span></span>
<span><span class="co">#&gt;         tktr &lt;- 6.24053043162953e-07</span></span>
<span><span class="co">#&gt;         label("1 - tktr")</span></span>
<span><span class="co">#&gt;         tka &lt;- -3.00642760553675e-06</span></span>
<span><span class="co">#&gt;         label("2 - tka")</span></span>
<span><span class="co">#&gt;         tcl &lt;- -2.00405074386117</span></span>
<span><span class="co">#&gt;         label("3 - tcl")</span></span>
<span><span class="co">#&gt;         tv &lt;- 2.05188410700476</span></span>
<span><span class="co">#&gt;         label("4 - tv")</span></span>
<span><span class="co">#&gt;         prop.err &lt;- c(0, 0.0985804613565218)</span></span>
<span><span class="co">#&gt;         label("5 - prop.err")</span></span>
<span><span class="co">#&gt;         pkadd.err &lt;- c(0, 0.511625249037084)</span></span>
<span><span class="co">#&gt;         label("6 - pkadd.err")</span></span>
<span><span class="co">#&gt;         temax &lt;- 6.4184983102259</span></span>
<span><span class="co">#&gt;         label("7 - temax")</span></span>
<span><span class="co">#&gt;         tec50 &lt;- 0.140763261319656</span></span>
<span><span class="co">#&gt;         label("8 - tec50")</span></span>
<span><span class="co">#&gt;         tkout &lt;- -2.9534704318737</span></span>
<span><span class="co">#&gt;         label("9 - tkout")</span></span>
<span><span class="co">#&gt;         te0 &lt;- 4.57045413136592</span></span>
<span><span class="co">#&gt;         label("10 - te0")</span></span>
<span><span class="co">#&gt;         pdadd.err &lt;- c(0, 3.71714384851537)</span></span>
<span><span class="co">#&gt;         label("11 - pdadd.err")</span></span>
<span><span class="co">#&gt;         eta.ktr ~ 0.558129815059436</span></span>
<span><span class="co">#&gt;         eta.ka ~ 0.558402321309217</span></span>
<span><span class="co">#&gt;         eta.cl ~ 0.0785849119252598</span></span>
<span><span class="co">#&gt;         eta.v ~ 0.0508226905750953</span></span>
<span><span class="co">#&gt;         eta.emax ~ 5e-05</span></span>
<span><span class="co">#&gt;         eta.ec50 ~ 0.18426809257979</span></span>
<span><span class="co">#&gt;         eta.kout ~ 0.0083631531443303</span></span>
<span><span class="co">#&gt;         eta.e0 ~ 0.00274561514766752</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;     model({</span></span>
<span><span class="co">#&gt;         cmt(DEPOT)</span></span>
<span><span class="co">#&gt;         cmt(GUT)</span></span>
<span><span class="co">#&gt;         cmt(CENTER)</span></span>
<span><span class="co">#&gt;         cmt(EFFECT)</span></span>
<span><span class="co">#&gt;         ktr &lt;- exp(tktr + eta.ktr)</span></span>
<span><span class="co">#&gt;         ka &lt;- exp(tka + eta.ka)</span></span>
<span><span class="co">#&gt;         cl &lt;- exp(tcl + eta.cl)</span></span>
<span><span class="co">#&gt;         v &lt;- exp(tv + eta.v)</span></span>
<span><span class="co">#&gt;         emax &lt;- expit(temax + eta.emax, 0, 1)</span></span>
<span><span class="co">#&gt;         ec50 &lt;- exp(tec50 + eta.ec50)</span></span>
<span><span class="co">#&gt;         kout &lt;- exp(tkout + eta.kout)</span></span>
<span><span class="co">#&gt;         e0 &lt;- exp(te0 + eta.e0)</span></span>
<span><span class="co">#&gt;         EFFECT(0) &lt;- e0</span></span>
<span><span class="co">#&gt;         dcp &lt;- CENTER/v</span></span>
<span><span class="co">#&gt;         pd &lt;- 1 - emax * dcp/(ec50 + dcp)</span></span>
<span><span class="co">#&gt;         kin &lt;- e0 * kout</span></span>
<span><span class="co">#&gt;         d/dt(DEPOT) &lt;- -ktr * DEPOT</span></span>
<span><span class="co">#&gt;         d/dt(GUT) &lt;- ktr * DEPOT - ka * GUT</span></span>
<span><span class="co">#&gt;         d/dt(CENTER) &lt;- ka * GUT - cl/v * CENTER</span></span>
<span><span class="co">#&gt;         d/dt(EFFECT) &lt;- kin * pd - kout * EFFECT</span></span>
<span><span class="co">#&gt;         eff &lt;- EFFECT</span></span>
<span><span class="co">#&gt;         dcp ~ add(pkadd.err) + prop(prop.err)</span></span>
<span><span class="co">#&gt;         eff ~ add(pdadd.err)</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;  ── <span style="font-weight: bold;">nonmem2rx extra properties:</span> ──  </span></span>
<span><span class="co">#&gt; other properties include: <span style="color: #0000BB; font-weight: bold;">$nonmemData</span>, <span style="color: #0000BB; font-weight: bold;">$etaData</span>, <span style="color: #0000BB; font-weight: bold;">$thetaMat</span></span></span>
<span><span class="co">#&gt; captured NONMEM table outputs: <span style="color: #0000BB; font-weight: bold;">$predData</span>, <span style="color: #0000BB; font-weight: bold;">$ipredData</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 comparison data: <span style="color: #0000BB; font-weight: bold;">$iwresCompare</span>, <span style="color: #0000BB; font-weight: bold;">$predCompare</span>, <span style="color: #0000BB; font-weight: bold;">$ipredCompare</span></span></span>
<span><span class="co">#&gt; NONMEM/rxode2 composite comparison: <span style="color: #0000BB; font-weight: bold;">$predAtol</span>, <span style="color: #0000BB; font-weight: bold;">$predRtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredAtol</span>, <span style="color: #0000BB; font-weight: bold;">$ipredRtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresAtol</span>, <span style="color: #0000BB; font-weight: bold;">$iwresRtol</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-3-convert-new-model-to-nlmixr2-fit-with-as-nlmixr2">Step 3: Convert new model to nlmixr2 fit with
<code>as.nlmixr2()</code><a class="anchor" aria-label="anchor" href="#step-3-convert-new-model-to-nlmixr2-fit-with-as-nlmixr2"></a>
</h2>
<p>Once the translation is complete, and it is validated, you can
convert the fit to a full nlmixr2 fit object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/babelmixr2/reference/as.nlmixr2.html" class="external-link">as.nlmixr2</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; rxode2 4.0.0 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span><span class="co">#&gt; → Calculating residuals/tables</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span><span class="co">#&gt; → compress parHistData in nlmixr2 object, save 5536</span></span>
<span></span>
<span><span class="co"># Once it is loaded remove the directory (we don't need the files any</span></span>
<span><span class="co"># more for this example)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># In this example, we don't remove, but note where it can be removed</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># unlink("pk.turnover.emax3-nonmem", recursive = TRUE)</span></span></code></pre></div>
<p>Note this object <strong>does not</strong> rerun an estimation, but
rather imports everything it knows about the fit to rerun the
<code>nlmixr2</code> table steps to calculate the things you need.</p>
</div>
<div class="section level2">
<h2 id="step-4-explore-the-datafit-as-if-it-came-from-nlmixr2">Step 4: Explore the data/fit as if it came from
<code>nlmixr2</code><a class="anchor" aria-label="anchor" href="#step-4-explore-the-datafit-as-if-it-came-from-nlmixr2"></a>
</h2>
<p>With this information you can see about the properties of the
model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">nonmem2rx</span><span style="font-weight: bold;"> reading NONMEM ver 7.4.3 ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               OBJF     AIC      BIC Log-likelihood</span></span>
<span><span class="co">#&gt; nonmem2rx 439.2156 1364.91 1444.331      -663.4551</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           setup table compress NONMEM as.nlmixr2</span></span>
<span><span class="co">#&gt; elapsed 0.03223 0.084    0.013 320.27      3.894</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                <span style="font-weight: bold;">Parameter</span>      <span style="font-weight: bold;">Est.</span> <span style="font-weight: bold;">Back-transformed</span> <span style="font-weight: bold;">BSV(CV% or SD)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>            1 - <span style="font-weight: bold;">tktr</span>  6.24e-07                1           86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>              2 - <span style="font-weight: bold;">tka</span> -3.01e-06                1           86.5      <span style="color: #BB0000; font-weight: bold;">59.8%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>              3 - <span style="font-weight: bold;">tcl</span>        -2            0.135           28.6      1.34% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>                4 - <span style="font-weight: bold;">tv</span>      2.05             7.78           22.8      6.44% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>    5 - <span style="font-weight: bold;">prop.err</span>    0.0986           0.0986                           </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>  6 - <span style="font-weight: bold;">pkadd.err</span>     0.512            0.512                           </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>          7 - <span style="font-weight: bold;">temax</span>      6.42            0.998        0.00707      <span style="color: #BB0000; font-weight: bold;">100.%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>          8 - <span style="font-weight: bold;">tec50</span>     0.141             1.15           45.0      6.06% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>          9 - <span style="font-weight: bold;">tkout</span>     -2.95           0.0522           9.16      <span style="color: #BB0000; font-weight: bold;">32.4%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>             10 - <span style="font-weight: bold;">te0</span>      4.57             96.6           5.24      18.1% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span> 11 - <span style="font-weight: bold;">pdadd.err</span>      3.72             3.72                           </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; 0MINIMIZATION TERMINATED</span></span>
<span><span class="co">#&gt;  DUE TO ROUNDING ERRORS (ERROR=134)</span></span>
<span><span class="co">#&gt;  NO. OF FUNCTION EVALUATIONS USED:     1088</span></span>
<span><span class="co">#&gt;  NO. OF SIG. DIGITS UNREPORTABLE</span></span>
<span><span class="co">#&gt; 0PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     IPRED relative difference compared to Nonmem IPRED: 0%; 95% percentile: (0%,0%); rtol=5.09e-06</span></span>
<span><span class="co">#&gt;     PRED relative difference compared to Nonmem PRED: 0%; 95% percentile: (0%,0%); rtol=5.29e-06</span></span>
<span><span class="co">#&gt;     IPRED absolute difference compared to Nonmem IPRED: 95% percentile: (2.2e-06, 0.000454); atol=3.03e-05</span></span>
<span><span class="co">#&gt;     PRED absolute difference compared to Nonmem PRED: 95% percentile: (4.72e-07,0.00361); atol=5.29e-06</span></span>
<span><span class="co">#&gt;     there are solving errors during optimization (see '$prderr')</span></span>
<span><span class="co">#&gt;     nonmem2rx model file: 'pk.turnover.emax3-nonmem/pk.turnover.emax3.nmctl' </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 483 × 35</span></span></span>
<span><span class="co">#&gt;   ID     TIME CMT      DV  PRED   RES IPRED   IRES  IWRES eta.ktr eta.ka eta.cl</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       0.5 dcp     0    1.16 -<span style="color: #BB0000;">1.16</span> 0.444 -<span style="color: #BB0000;">0.444</span> -<span style="color: #BB0000;">0.864</span>  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       1   dcp     1.9  3.37 -<span style="color: #BB0000;">1.47</span> 1.45   0.446  0.840  -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       2   dcp     3.3  7.51 -<span style="color: #BB0000;">4.21</span> 3.96  -<span style="color: #BB0000;">0.660</span> -<span style="color: #BB0000;">1.03</span>   -<span style="color: #BB0000;">0.506</span> -<span style="color: #BB0000;">0.506</span>  0.699</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 480 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more variables: eta.v &lt;dbl&gt;, eta.emax &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.kout &lt;dbl&gt;, eta.e0 &lt;dbl&gt;, dcp &lt;dbl&gt;, eff &lt;dbl&gt;, DEPOT &lt;dbl&gt;, GUT &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CENTER &lt;dbl&gt;, EFFECT &lt;dbl&gt;, ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;, e0 &lt;dbl&gt;, pd &lt;dbl&gt;, kin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>In this model you can see:</p>
<ul>
<li>High shrinkage in <code>temax</code>, <code>ktr</code>,
<code>ka</code> and moderate shrinkage in <code>kout</code>
</li>
</ul>
<p>By removing these parameters, you could possibly get a successful
NONMEM run.</p>
<p>If you want, you can use model piping to remove these parameters as
follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">&lt;-</span>  <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">emax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/logit.html" class="external-link">expit</a></span><span class="op">(</span><span class="va">temax</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">kout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.ktr`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.ka`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.emax`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> remove between subject variability `eta.kout`</span></span>
<span></span>
<span><span class="va">mod3</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mi>U</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>t</mi><mi>r</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>t</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>a</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>c</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>v</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>c</mi><mn>50</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mn>0</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mn>0</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mo>−</mo><mfrac><mrow><mi>c</mi><mi>l</mi></mrow><mi>v</mi></mfrac><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>i</mi><mi>n</mi></mrow><mo>×</mo><mrow><mi>p</mi><mi>d</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>×</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>k</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>d</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
cmt({DEPOT}) \\
cmt({GUT}) \\
cmt({CENTER}) \\
cmt({EFFECT}) \\
{ktr} &amp; = \exp\left({tktr}\right) \\
{ka} &amp; = \exp\left({tka}\right) \\
{cl} &amp; = \exp\left({tcl}+{eta.cl}\right) \\
{v} &amp; = \exp\left({tv}+{eta.v}\right) \\
{emax} &amp; = expit({temax}, {0}, {1}) \\
{ec50} &amp; = \exp\left({tec50}+{eta.ec50}\right) \\
{kout} &amp; = \exp\left({tkout}\right) \\
{e0} &amp; = \exp\left({te0}+{eta.e0}\right) \\
EFFECT({0}) &amp; = {e0} \\
{dcp} &amp; = \frac{{CENTER}}{{v}} \\
{pd} &amp; = {1}-\frac{{emax} {\times} {dcp}}{\left({ec50}+{dcp}\right)} \\
{kin} &amp; = {e0} {\times} {kout} \\
\frac{d \: DEPOT}{dt} &amp; = -{ktr} {\times} {DEPOT} \\
\frac{d \: GUT}{dt} &amp; = {ktr} {\times} {DEPOT}-{ka} {\times} {GUT} \\
\frac{d \: CENTER}{dt} &amp; = {ka} {\times} {GUT}-\frac{{cl}}{{v}} {\times} {CENTER} \\
\frac{d \: EFFECT}{dt} &amp; = {kin} {\times} {pd}-{kout} {\times} {EFFECT} \\
{eff} &amp; = {EFFECT} \\
{dcp} &amp; \sim add({pkadd.err})+prop({prop.err}) \\
{eff} &amp; \sim add({pdadd.err})
\end{align*}</annotation></semantics></math></p>
<p>Since you have <code>babelmixr2</code> you could use
<code>babelmixr2</code> to run the model for you in NONMEM (if you have
it setup to run NONMEM), or even run the model from <code>nlmixr2</code>
itself. In this example we will choose to use <code>nlmixr2</code>
(since the <code>babelmixr2</code> example runs NONMEM and shows a
reduction in shrinkage)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/nlmixr2est/reference/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="va">new</span><span class="op">$</span><span class="va">nonmemData</span>, <span class="st">"focei"</span>, <span class="fu"><a href="https://nlmixr2.github.io/nlmixr2est/reference/foceiControl.html" class="external-link">foceiControl</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → calculate jacobian</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate sensitivities</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate ∂(f)/∂(η)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate ∂(R²)/∂(η)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling inner model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compiling events FD model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; calculating covariance matrix</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:28 </span></span>
<span><span class="co">#&gt; done</span></span>
<span><span class="co">#&gt; → Calculating residuals/tables</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span><span class="co">#&gt; → compress parHistData in nlmixr2 object, save 14920</span></span>
<span></span>
<span><span class="va">fit2</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mi>U</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>t</mi><mi>r</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>t</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>a</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>c</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>v</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>c</mi><mn>50</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mn>0</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mn>0</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mo>−</mo><mfrac><mrow><mi>c</mi><mi>l</mi></mrow><mi>v</mi></mfrac><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>i</mi><mi>n</mi></mrow><mo>×</mo><mrow><mi>p</mi><mi>d</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>×</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>k</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>d</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
cmt({DEPOT}) \\
cmt({GUT}) \\
cmt({CENTER}) \\
cmt({EFFECT}) \\
{ktr} &amp; = \exp\left({tktr}\right) \\
{ka} &amp; = \exp\left({tka}\right) \\
{cl} &amp; = \exp\left({tcl}+{eta.cl}\right) \\
{v} &amp; = \exp\left({tv}+{eta.v}\right) \\
{emax} &amp; = expit({temax}, {0}, {1}) \\
{ec50} &amp; = \exp\left({tec50}+{eta.ec50}\right) \\
{kout} &amp; = \exp\left({tkout}\right) \\
{e0} &amp; = \exp\left({te0}+{eta.e0}\right) \\
EFFECT({0}) &amp; = {e0} \\
{dcp} &amp; = \frac{{CENTER}}{{v}} \\
{pd} &amp; = {1}-\frac{{emax} {\times} {dcp}}{\left({ec50}+{dcp}\right)} \\
{kin} &amp; = {e0} {\times} {kout} \\
\frac{d \: DEPOT}{dt} &amp; = -{ktr} {\times} {DEPOT} \\
\frac{d \: GUT}{dt} &amp; = {ktr} {\times} {DEPOT}-{ka} {\times} {GUT} \\
\frac{d \: CENTER}{dt} &amp; = {ka} {\times} {GUT}-\frac{{cl}}{{v}} {\times} {CENTER} \\
\frac{d \: EFFECT}{dt} &amp; = {kin} {\times} {pd}-{kout} {\times} {EFFECT} \\
{eff} &amp; = {EFFECT} \\
{dcp} &amp; \sim add({pkadd.err})+prop({prop.err}) \\
{eff} &amp; \sim add({pdadd.err})
\end{align*}</annotation></semantics></math></p>
<p>With these modifications the shrinkage is also reduced (just like in
the NONMEM case)</p>
</div>
<div class="section level2">
<h2 id="step-5-get-the-covariance-of-the-model">Step 5: Get the covariance of the model<a class="anchor" aria-label="anchor" href="#step-5-get-the-covariance-of-the-model"></a>
</h2>
<p>Another thing that can be helpful when the fit has been imported into
a <code>nlmixr2</code> fit is to get the variance/covariance matrix.
This can be especially helpful to diagnose things to help simplify your
model</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getVarCov.html" class="external-link">getVarCov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; → loading into <span style="color: #0000BB;">symengine</span> environment...</span></span>
<span><span class="co">#&gt; → pruning branches (`if`/`else`) of full model...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → calculate jacobian</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate sensitivities</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → calculate ∂(f)/∂(η)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in inner model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in EBE model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling inner model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → finding duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → optimizing duplicate expressions in FD model...</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; → compiling EBE model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; → compiling events FD model...</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> done</span></span>
<span><span class="co">#&gt; calculating covariance matrix</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:04</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): using R matrix to calculate covariance, can</span></span>
<span><span class="co">#&gt; check sandwich or S matrix with $covRS and $covS</span></span>
<span><span class="co">#&gt; Warning in foceiFitCpp_(.ret): gradient problems with covariance; see</span></span>
<span><span class="co">#&gt; $scaleInfo</span></span>
<span><span class="co">#&gt; → compress origData in nlmixr2 object, save 21592</span></span>
<span><span class="co">#&gt; Updated original fit object <span style="color: #BBBB00;">fit</span></span></span>
<span><span class="co">#&gt;                tktr           tka           tcl           tv         temax</span></span>
<span><span class="co">#&gt; tktr   1.830060e-02 -1.523057e-02 -2.404755e-05 3.183949e-04  0.0011992673</span></span>
<span><span class="co">#&gt; tka   -1.523057e-02  1.828061e-02 -2.125855e-05 3.195745e-04  0.0014273042</span></span>
<span><span class="co">#&gt; tcl   -2.404755e-05 -2.125855e-05  2.479870e-04 1.184906e-05 -0.0008486078</span></span>
<span><span class="co">#&gt; tv     3.183949e-04  3.195745e-04  1.184906e-05 3.183331e-04  0.0011376028</span></span>
<span><span class="co">#&gt; temax  1.199267e-03  1.427304e-03 -8.486078e-04 1.137603e-03  7.5951592101</span></span>
<span><span class="co">#&gt; tec50  1.333848e-04  1.362464e-04 -3.585788e-04 1.232516e-04  0.0485635015</span></span>
<span><span class="co">#&gt; tkout  9.641362e-05  1.069037e-04 -9.755546e-05 1.189674e-04 -0.0189321828</span></span>
<span><span class="co">#&gt; te0    1.365383e-05  1.343098e-05 -9.855499e-06 1.252947e-05 -0.0004450840</span></span>
<span><span class="co">#&gt;               tec50         tkout           te0</span></span>
<span><span class="co">#&gt; tktr   0.0001333848  9.641362e-05  1.365383e-05</span></span>
<span><span class="co">#&gt; tka    0.0001362464  1.069037e-04  1.343098e-05</span></span>
<span><span class="co">#&gt; tcl   -0.0003585788 -9.755546e-05 -9.855499e-06</span></span>
<span><span class="co">#&gt; tv     0.0001232516  1.189674e-04  1.252947e-05</span></span>
<span><span class="co">#&gt; temax  0.0485635015 -1.893218e-02 -4.450840e-04</span></span>
<span><span class="co">#&gt; tec50  0.0018384895  1.539214e-04 -1.360918e-04</span></span>
<span><span class="co">#&gt; tkout  0.0001539214  6.316775e-04  5.255583e-05</span></span>
<span><span class="co">#&gt; te0   -0.0001360918  5.255583e-05  8.870276e-05</span></span>
<span><span class="va">fit</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mi>U</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>t</mi><mi>r</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>a</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>a</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>c</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>v</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>c</mi><mn>50</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mn>0</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mn>0</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mi>d</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>d</mi><mi>c</mi><mi>p</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>E</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>G</mi><mi>U</mi><mi>T</mi></mrow><mo>−</mo><mfrac><mrow><mi>c</mi><mi>l</mi></mrow><mi>v</mi></mfrac><mo>×</mo><mrow><mi>C</mi><mi>E</mi><mi>N</mi><mi>T</mi><mi>E</mi><mi>R</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>i</mi><mi>n</mi></mrow><mo>×</mo><mrow><mi>p</mi><mi>d</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>×</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>E</mi><mi>F</mi><mi>F</mi><mi>E</mi><mi>C</mi><mi>T</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>k</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>d</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
cmt({DEPOT}) \\
cmt({GUT}) \\
cmt({CENTER}) \\
cmt({EFFECT}) \\
{ktr} &amp; = \exp\left({tktr}+{eta.ktr}\right) \\
{ka} &amp; = \exp\left({tka}+{eta.ka}\right) \\
{cl} &amp; = \exp\left({tcl}+{eta.cl}\right) \\
{v} &amp; = \exp\left({tv}+{eta.v}\right) \\
{emax} &amp; = expit({temax}+{eta.emax}, {0}, {1}) \\
{ec50} &amp; = \exp\left({tec50}+{eta.ec50}\right) \\
{kout} &amp; = \exp\left({tkout}+{eta.kout}\right) \\
{e0} &amp; = \exp\left({te0}+{eta.e0}\right) \\
EFFECT({0}) &amp; = {e0} \\
{dcp} &amp; = \frac{{CENTER}}{{v}} \\
{pd} &amp; = {1}-\frac{{emax} {\times} {dcp}}{\left({ec50}+{dcp}\right)} \\
{kin} &amp; = {e0} {\times} {kout} \\
\frac{d \: DEPOT}{dt} &amp; = -{ktr} {\times} {DEPOT} \\
\frac{d \: GUT}{dt} &amp; = {ktr} {\times} {DEPOT}-{ka} {\times} {GUT} \\
\frac{d \: CENTER}{dt} &amp; = {ka} {\times} {GUT}-\frac{{cl}}{{v}} {\times} {CENTER} \\
\frac{d \: EFFECT}{dt} &amp; = {kin} {\times} {pd}-{kout} {\times} {EFFECT} \\
{eff} &amp; = {EFFECT} \\
{dcp} &amp; \sim add({pkadd.err})+prop({prop.err}) \\
{eff} &amp; \sim add({pdadd.err})
\end{align*}</annotation></semantics></math></p>
<p>Note this covariance step is not 100% successful since it is not
<code>r, s</code>. However, it can give some insights on which
parameters are estimated well. In this case you can see that the
<code>emax</code> parameter is more poorly estimated than other
parameters, which means fixing the parameter or reducing other
parameters may help your estimate progress in <code>NONMEM</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
